\doxysection{Vit\+NX.\+Functions.\+Common.\+File\+System Class Reference}
\label{a00328}\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static List$<$ string $>$ \textbf{ Return\+Recurs\+FList} (string path)
\item 
static long \textbf{ Get\+Directory\+Size} (Directory\+Info path)
\item 
static void \textbf{ Delete\+File} (string file)
\item 
static void \textbf{ Delete\+File\+In\+Trash} (string file)
\item 
static void \textbf{ Delete\+Directory\+To\+Trash} (string path)
\item 
static string[$\,$] \textbf{ Write\+Text\+To\+File\+UTF8} (string text, string file)
\item 
static string \textbf{ Get\+Text} (string file)
\item 
static string \textbf{ Get\+MD5} (string file)
\item 
static string \textbf{ File\+Name\+Generator} (string tag, string extension)
\item 
static void \textbf{ Clean\+Recycle\+Bin} ()
\item 
static void \textbf{ Create\+File\+Backup} (string file, string new\+\_\+file\+\_\+extension, bool save\+\_\+old\+\_\+file)
\item 
static void \textbf{ Create\+Shortcut} (string shortcut, string file, string exe\+\_\+name)
\item 
static void \textbf{ Copy\+Folder} (string from, string where)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \textbf{ 7} of file \textbf{ File\+System.\+cs}.



\doxysubsection{Member Function Documentation}
\mbox{\label{a00328_a8694ebe53a440086153741845e8442d4}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!CleanRecycleBin@{CleanRecycleBin}}
\index{CleanRecycleBin@{CleanRecycleBin}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{CleanRecycleBin()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Clean\+Recycle\+Bin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 102} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00103         \{}
\DoxyCodeLine{00104             Windows.Win32.Import.SHEmptyRecycleBin(IntPtr.Zero, \textcolor{keyword}{null},}
\DoxyCodeLine{00105 Windows.Win32.Enums.SHERB\_RECYCLE.SHERB\_NOSOUND |}
\DoxyCodeLine{00106 Windows.Win32.Enums.SHERB\_RECYCLE.SHERB\_NOCONFIRMATION);}
\DoxyCodeLine{00107         \}}

\end{DoxyCode}
\mbox{\label{a00328_a8d4f0af6fe8b1ad26696e147eb5b62e7}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!CopyFolder@{CopyFolder}}
\index{CopyFolder@{CopyFolder}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{CopyFolder()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Copy\+Folder (\begin{DoxyParamCaption}\item[{string}]{from,  }\item[{string}]{where }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 130} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00131         \{ Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(from, where); \}}

\end{DoxyCode}
\mbox{\label{a00328_a9a58e95791e90305be9064ceab291b0f}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!CreateFileBackup@{CreateFileBackup}}
\index{CreateFileBackup@{CreateFileBackup}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{CreateFileBackup()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Create\+File\+Backup (\begin{DoxyParamCaption}\item[{string}]{file,  }\item[{string}]{new\+\_\+file\+\_\+extension,  }\item[{bool}]{save\+\_\+old\+\_\+file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 109} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00110         \{}
\DoxyCodeLine{00111             \textcolor{keywordtype}{string} bak\_file = file + \textcolor{stringliteral}{"{}."{}} + new\_file\_extension.Replace(\textcolor{stringliteral}{"{}."{}}, \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00112             \textcolor{keywordflow}{if} (File.Exists(bak\_file)) \{ \textcolor{keywordflow}{try} \{ File.Delete(bak\_file); \} \textcolor{keywordflow}{catch} \{ \} \}}
\DoxyCodeLine{00113             \textcolor{keywordflow}{if} (save\_old\_file == \textcolor{keyword}{false}) \{ \textcolor{keywordflow}{try} \{ File.Move(file, bak\_file); \} \textcolor{keywordflow}{catch} \{ \} \}}
\DoxyCodeLine{00114             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00115             \{}
\DoxyCodeLine{00116                 File.Copy(file, bak\_file);}
\DoxyCodeLine{00117                 \textcolor{keywordflow}{try} \{ File.Delete(file); \} \textcolor{keywordflow}{catch} \{ \}}
\DoxyCodeLine{00118             \}}
\DoxyCodeLine{00119         \}}

\end{DoxyCode}
\mbox{\label{a00328_a567b2fe47f9cf888946fe1d33db99ee8}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!CreateShortcut@{CreateShortcut}}
\index{CreateShortcut@{CreateShortcut}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{CreateShortcut()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Create\+Shortcut (\begin{DoxyParamCaption}\item[{string}]{shortcut,  }\item[{string}]{file,  }\item[{string}]{exe\+\_\+name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 121} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00122         \{}
\DoxyCodeLine{00123             IWshRuntimeLibrary.WshShell wshShell = \textcolor{keyword}{new} IWshRuntimeLibrary.WshShell();}
\DoxyCodeLine{00124             IWshRuntimeLibrary.IWshShortcut Shortcut = (IWshRuntimeLibrary.IWshShortcut)wshShell.CreateShortcut(shortcut);}
\DoxyCodeLine{00125             Shortcut.TargetPath = file;}
\DoxyCodeLine{00126             Shortcut.WorkingDirectory = file.Replace(\textcolor{stringliteral}{@"{}\(\backslash\)"{}} + exe\_name, \textcolor{stringliteral}{"{}"{}}).Replace(\textcolor{stringliteral}{"{}.exe"{}}, \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00127             Shortcut.Save();}
\DoxyCodeLine{00128         \}}

\end{DoxyCode}
\mbox{\label{a00328_aa0258ec8727a37666ea4772b39bfcf56}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!DeleteDirectoryToTrash@{DeleteDirectoryToTrash}}
\index{DeleteDirectoryToTrash@{DeleteDirectoryToTrash}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{DeleteDirectoryToTrash()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Delete\+Directory\+To\+Trash (\begin{DoxyParamCaption}\item[{string}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 49} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050         \{}
\DoxyCodeLine{00051             Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory(path,}
\DoxyCodeLine{00052                 Microsoft.VisualBasic.FileIO.UIOption.OnlyErrorDialogs,}
\DoxyCodeLine{00053                 Microsoft.VisualBasic.FileIO.RecycleOption.SendToRecycleBin);}
\DoxyCodeLine{00054         \}}

\end{DoxyCode}
\mbox{\label{a00328_a0f515972cdb6ee9896ba020f45ffdd2d}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!DeleteFile@{DeleteFile}}
\index{DeleteFile@{DeleteFile}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{DeleteFile()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Delete\+File (\begin{DoxyParamCaption}\item[{string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 35} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00036         \{}
\DoxyCodeLine{00037             \textcolor{keywordflow}{try} \{ File.Delete(file); \}}
\DoxyCodeLine{00038             \textcolor{keywordflow}{catch} \{ \}}
\DoxyCodeLine{00039         \}}

\end{DoxyCode}
\mbox{\label{a00328_a45f8132bd5baa0d56dbccabfb1cd1b8a}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!DeleteFileInTrash@{DeleteFileInTrash}}
\index{DeleteFileInTrash@{DeleteFileInTrash}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{DeleteFileInTrash()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Common.\+File\+System.\+Delete\+File\+In\+Trash (\begin{DoxyParamCaption}\item[{string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 41} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00042         \{}
\DoxyCodeLine{00043             \textcolor{keywordflow}{try} \{ File.SetAttributes(file, FileAttributes.Normal); \} \textcolor{keywordflow}{catch} \{ \}}
\DoxyCodeLine{00044             Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile(file,}
\DoxyCodeLine{00045                 Microsoft.VisualBasic.FileIO.UIOption.OnlyErrorDialogs,}
\DoxyCodeLine{00046                 Microsoft.VisualBasic.FileIO.RecycleOption.SendToRecycleBin);}
\DoxyCodeLine{00047         \}}

\end{DoxyCode}
\mbox{\label{a00328_a3a0a4dc06a75c041b6abff8d6cee9668}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!FileNameGenerator@{FileNameGenerator}}
\index{FileNameGenerator@{FileNameGenerator}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{FileNameGenerator()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Common.\+File\+System.\+File\+Name\+Generator (\begin{DoxyParamCaption}\item[{string}]{tag,  }\item[{string}]{extension }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 92} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093         \{}
\DoxyCodeLine{00094             \textcolor{keywordtype}{string} fileName = \textcolor{keywordtype}{string}.Format(\textcolor{stringliteral}{"{}\{0\}\_\{1\}\_\{2\}.\{3\}"{}},}
\DoxyCodeLine{00095                 tag,}
\DoxyCodeLine{00096                 DateTime.Now.ToString(\textcolor{stringliteral}{"{}yyyyMMddHHmmssfff"{}}),}
\DoxyCodeLine{00097                 Guid.NewGuid(),}
\DoxyCodeLine{00098                 extension);}
\DoxyCodeLine{00099             \textcolor{keywordflow}{return} fileName;}
\DoxyCodeLine{00100         \}}

\end{DoxyCode}
\mbox{\label{a00328_ad5d3f03a8ab20ac9e4325ef2badd912e}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!GetDirectorySize@{GetDirectorySize}}
\index{GetDirectorySize@{GetDirectorySize}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{GetDirectorySize()}
{\footnotesize\ttfamily static long Vit\+NX.\+Functions.\+Common.\+File\+System.\+Get\+Directory\+Size (\begin{DoxyParamCaption}\item[{Directory\+Info}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 23} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00024         \{}
\DoxyCodeLine{00025             \textcolor{keywordtype}{long} size = 0;}
\DoxyCodeLine{00026             FileInfo[] fis = path.GetFiles();}
\DoxyCodeLine{00027             \textcolor{keywordflow}{foreach} (FileInfo fi \textcolor{keywordflow}{in} fis)}
\DoxyCodeLine{00028                 size += fi.Length;}
\DoxyCodeLine{00029             DirectoryInfo[] dis = path.GetDirectories();}
\DoxyCodeLine{00030             \textcolor{keywordflow}{foreach} (DirectoryInfo di \textcolor{keywordflow}{in} dis)}
\DoxyCodeLine{00031                 size += GetDirectorySize(di);}
\DoxyCodeLine{00032             \textcolor{keywordflow}{return} size;}
\DoxyCodeLine{00033         \}}

\end{DoxyCode}
\mbox{\label{a00328_a3f79c7893824d812dc0eace5c48c26f3}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!GetMD5@{GetMD5}}
\index{GetMD5@{GetMD5}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{GetMD5()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Common.\+File\+System.\+Get\+MD5 (\begin{DoxyParamCaption}\item[{string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 77} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00078         \{}
\DoxyCodeLine{00079             \textcolor{keyword}{using} (var md5 = System.Security.Cryptography.MD5.Create())}
\DoxyCodeLine{00080             \{}
\DoxyCodeLine{00081                 \textcolor{keyword}{using} (var Stream = File.OpenRead(@file))}
\DoxyCodeLine{00082                 \{}
\DoxyCodeLine{00083                     var hashBytes = md5.ComputeHash(Stream);}
\DoxyCodeLine{00084                     var sb = \textcolor{keyword}{new} System.Text.StringBuilder();}
\DoxyCodeLine{00085                     \textcolor{keywordflow}{foreach} (var t \textcolor{keywordflow}{in} hashBytes)}
\DoxyCodeLine{00086                         sb.Append(t.ToString(\textcolor{stringliteral}{"{}X2"{}}));}
\DoxyCodeLine{00087                     \textcolor{keywordflow}{return} Convert.ToString(sb);}
\DoxyCodeLine{00088                 \}}
\DoxyCodeLine{00089             \}}
\DoxyCodeLine{00090         \}}

\end{DoxyCode}
\mbox{\label{a00328_a50a4e7523e86625541f17b386944f5d9}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!GetText@{GetText}}
\index{GetText@{GetText}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{GetText()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Common.\+File\+System.\+Get\+Text (\begin{DoxyParamCaption}\item[{string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 69} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00070         \{}
\DoxyCodeLine{00071             \textcolor{keywordtype}{string} text = \textcolor{stringliteral}{"{}Text file not found"{}};}
\DoxyCodeLine{00072             \textcolor{keyword}{using} (StreamReader sr = File.OpenText(file))}
\DoxyCodeLine{00073                 text = sr.ReadToEnd();}
\DoxyCodeLine{00074             \textcolor{keywordflow}{return} text;}
\DoxyCodeLine{00075         \}}

\end{DoxyCode}
\mbox{\label{a00328_a81a2fecd33c633291d98e96340423c8b}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!ReturnRecursFList@{ReturnRecursFList}}
\index{ReturnRecursFList@{ReturnRecursFList}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{ReturnRecursFList()}
{\footnotesize\ttfamily static List$<$ string $>$ Vit\+NX.\+Functions.\+Common.\+File\+System.\+Return\+Recurs\+FList (\begin{DoxyParamCaption}\item[{string}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 9} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00010         \{}
\DoxyCodeLine{00011             List<string> ls = \textcolor{keyword}{new} List<string>();}
\DoxyCodeLine{00012             \textcolor{keywordflow}{try}}
\DoxyCodeLine{00013             \{}
\DoxyCodeLine{00014                 \textcolor{keywordtype}{string}[] folders = Directory.GetDirectories(path);}
\DoxyCodeLine{00015                 \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} folder \textcolor{keywordflow}{in} folders) ls.Add(\textcolor{stringliteral}{"{}Папка: "{}} + folder);}
\DoxyCodeLine{00016                 \textcolor{keywordtype}{string}[] files = Directory.GetFiles(path);}
\DoxyCodeLine{00017                 \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} filename \textcolor{keywordflow}{in} files) ls.Add(\textcolor{stringliteral}{"{}Файл: "{}} + filename);}
\DoxyCodeLine{00018             \}}
\DoxyCodeLine{00019             \textcolor{keywordflow}{catch} (Exception e) \{ ls.Add(e.Message.Trim(\textcolor{charliteral}{'\(\backslash\)n'})); \}}
\DoxyCodeLine{00020             \textcolor{keywordflow}{return} ls;}
\DoxyCodeLine{00021         \}}

\end{DoxyCode}
\mbox{\label{a00328_ae81f5a2fa8059e812744bff5845d2bf1}} 
\index{VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}!WriteTextToFileUTF8@{WriteTextToFileUTF8}}
\index{WriteTextToFileUTF8@{WriteTextToFileUTF8}!VitNX.Functions.Common.FileSystem@{VitNX.Functions.Common.FileSystem}}
\doxysubsubsection{WriteTextToFileUTF8()}
{\footnotesize\ttfamily static string[$\,$] Vit\+NX.\+Functions.\+Common.\+File\+System.\+Write\+Text\+To\+File\+UTF8 (\begin{DoxyParamCaption}\item[{string}]{text,  }\item[{string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 56} of file \textbf{ File\+System.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00057         \{}
\DoxyCodeLine{00058             \textcolor{keywordtype}{string} fileName = FileNameGenerator(file, \textcolor{stringliteral}{"{}txt"{}});}
\DoxyCodeLine{00059             \textcolor{keywordtype}{string} filePath = \$\textcolor{stringliteral}{@"{}\{Path.GetTempPath()\}\(\backslash\)\{fileName\}"{}};}
\DoxyCodeLine{00060             \textcolor{keyword}{using} (FileStream fs = File.OpenWrite(filePath))}
\DoxyCodeLine{00061             \{}
\DoxyCodeLine{00062                 var data = text;}
\DoxyCodeLine{00063                 \textcolor{keywordtype}{byte}[] bytes = System.Text.Encoding.UTF8.GetBytes(data);}
\DoxyCodeLine{00064                 fs.Write(bytes, 0, bytes.Length);}
\DoxyCodeLine{00065             \}}
\DoxyCodeLine{00066             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \textcolor{keywordtype}{string}[] \{ fileName, filePath \};}
\DoxyCodeLine{00067         \}}

\end{DoxyCode}
