\doxysection{Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows Class Reference}
\label{a00336}\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static bool \textbf{ Is64x} ()
\item 
static string \textbf{ Get\+Version} ()
\item 
static double \textbf{ Get\+Current\+Version\+From\+REG} ()
\item 
static string \textbf{ Get\+Edition\+IDFrom\+REG} ()
\item 
static string \textbf{ Get\+Current\+Build\+Number\+From\+REG} ()
\item 
static string \textbf{ Get\+Product\+Name\+From\+REG} ()
\item 
static string \textbf{ Get\+Display\+Version\+From\+REG} ()
\item 
static string \textbf{ Get\+Release\+Id\+From\+REG} ()
\item 
static Memory\+Stream \textbf{ Get\+Screen} ()
\item 
static void \textbf{ Get\+All\+Users} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \textbf{ 12} of file \textbf{ Computer.\+cs}.



\doxysubsection{Member Function Documentation}
\mbox{\label{a00336_a2fa8b64ac3f5c433355f38a267145840}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetAllUsers@{GetAllUsers}}
\index{GetAllUsers@{GetAllUsers}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetAllUsers()}
{\footnotesize\ttfamily static void Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+All\+Users (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 49} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050         \{}
\DoxyCodeLine{00051             \textcolor{keywordtype}{string} users = Processes.Execute(\textcolor{stringliteral}{"{}wmic"{}}, \textcolor{stringliteral}{"{}useraccount list full"{}});}
\DoxyCodeLine{00052             \textcolor{keywordtype}{string} temp\_file = \$\textcolor{stringliteral}{@"{}\{Path.GetTempPath()\}\(\backslash\)Пользователи.txt"{}};}
\DoxyCodeLine{00053             FileSystem.WriteTextToFileUTF8(users, temp\_file);}
\DoxyCodeLine{00054             \textcolor{keywordtype}{string}[] lines = File.ReadAllLines(temp\_file);}
\DoxyCodeLine{00055             \textcolor{keyword}{using} (StreamWriter writer = \textcolor{keyword}{new} StreamWriter(temp\_file))}
\DoxyCodeLine{00056             \{}
\DoxyCodeLine{00057                 \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} line \textcolor{keywordflow}{in} lines)}
\DoxyCodeLine{00058                 \{}
\DoxyCodeLine{00059                     \textcolor{keywordflow}{if} (!\textcolor{keywordtype}{string}.IsNullOrWhiteSpace(line))}
\DoxyCodeLine{00060                         writer.WriteLine(line);}
\DoxyCodeLine{00061                 \}}
\DoxyCodeLine{00062             \}}
\DoxyCodeLine{00063             \textcolor{keywordtype}{string}[] rep = File.ReadAllLines(temp\_file);}
\DoxyCodeLine{00064             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < rep.Length; i++)}
\DoxyCodeLine{00065             \{}
\DoxyCodeLine{00066                 \textcolor{keywordflow}{if} (i == 0)}
\DoxyCodeLine{00067                 \{}
\DoxyCodeLine{00068                     rep[0] = \textcolor{stringliteral}{"{}Пользователи:\(\backslash\)n\(\backslash\)n"{}} + rep[0];}
\DoxyCodeLine{00069                 \}}
\DoxyCodeLine{00070                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}TRUE"{}}, \textcolor{stringliteral}{"{}Да"{}});}
\DoxyCodeLine{00071                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}FALSE"{}}, \textcolor{stringliteral}{"{}Нет"{}});}
\DoxyCodeLine{00072                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Description"{}}, \textcolor{stringliteral}{"{}Описание"{}});}
\DoxyCodeLine{00073                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Domain"{}}, \textcolor{stringliteral}{"{}Домен"{}});}
\DoxyCodeLine{00074                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}FullName"{}}, \textcolor{stringliteral}{"{}Полное имя"{}});}
\DoxyCodeLine{00075                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Name"{}}, \textcolor{stringliteral}{"{}Имя"{}});}
\DoxyCodeLine{00076                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}LocalAccount"{}}, \textcolor{stringliteral}{"{}Локальная запись"{}});}
\DoxyCodeLine{00077                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Disabled"{}}, \textcolor{stringliteral}{"{}Отключена"{}});}
\DoxyCodeLine{00078                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Status"{}}, \textcolor{stringliteral}{"{}Статус"{}});}
\DoxyCodeLine{00079                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Lockout"{}}, \textcolor{stringliteral}{"{}Блокировка"{}});}
\DoxyCodeLine{00080                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Degraded"{}}, \textcolor{stringliteral}{"{}Отключён\(\backslash\)n"{}});}
\DoxyCodeLine{00081                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}InstallDate"{}}, \textcolor{stringliteral}{"{}Дата создания"{}});}
\DoxyCodeLine{00082                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}AccountType"{}}, \textcolor{stringliteral}{"{}Тип учётной записи"{}});}
\DoxyCodeLine{00083                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordChangeable"{}}, \textcolor{stringliteral}{"{}Пароль можно изменить"{}});}
\DoxyCodeLine{00084                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordExpires"{}}, \textcolor{stringliteral}{"{}Срок действия пароля истекает"{}});}
\DoxyCodeLine{00085                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordRequired"{}}, \textcolor{stringliteral}{"{}Требуется пароль"{}});}
\DoxyCodeLine{00086                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}512"{}}, \textcolor{stringliteral}{"{}Обычный [512]"{}}).Replace(\textcolor{stringliteral}{"{}2"{}}, \textcolor{stringliteral}{"{}Отключённый [2]"{}}).Replace(\textcolor{stringliteral}{"{}256"{}}, \textcolor{stringliteral}{"{}Временная дублирующая учётная запись [256]"{}}).Replace(\textcolor{stringliteral}{"{}128"{}}, \textcolor{stringliteral}{"{}Разрешён зашифрованный пароль [128]"{}});}
\DoxyCodeLine{00087                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}OK"{}}, \textcolor{stringliteral}{"{}Включён\(\backslash\)n"{}});}
\DoxyCodeLine{00088             \}}
\DoxyCodeLine{00089             File.WriteAllLines(temp\_file, rep);}
\DoxyCodeLine{00090         \}}

\end{DoxyCode}
\mbox{\label{a00336_a2539cec8873dc7e6bea3f2d6b0261d26}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetCurrentBuildNumberFromREG@{GetCurrentBuildNumberFromREG}}
\index{GetCurrentBuildNumberFromREG@{GetCurrentBuildNumberFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetCurrentBuildNumberFromREG()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Current\+Build\+Number\+From\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 26} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00027         \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}CurrentBuildNumber"{}}, \textcolor{stringliteral}{"{}"{}}); \}}

\end{DoxyCode}
\mbox{\label{a00336_ae23330df777e59a8c7f418be458d71f3}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetCurrentVersionFromREG@{GetCurrentVersionFromREG}}
\index{GetCurrentVersionFromREG@{GetCurrentVersionFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetCurrentVersionFromREG()}
{\footnotesize\ttfamily static double Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Current\+Version\+From\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 20} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00021         \{ \textcolor{keywordflow}{return} \textcolor{keywordtype}{double}.Parse((\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}CurrentVersion"{}}, \textcolor{stringliteral}{"{}"{}}), System.Globalization.CultureInfo.InvariantCulture); \}}

\end{DoxyCode}
\mbox{\label{a00336_abb63e3c3c22ee1c767b6d1a4b892afab}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetDisplayVersionFromREG@{GetDisplayVersionFromREG}}
\index{GetDisplayVersionFromREG@{GetDisplayVersionFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetDisplayVersionFromREG()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Display\+Version\+From\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 32} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00033         \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}DisplayVersion"{}}, \textcolor{stringliteral}{"{}"{}}); \}}

\end{DoxyCode}
\mbox{\label{a00336_af74fb37c47df73f4b35d576168cce195}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetEditionIDFromREG@{GetEditionIDFromREG}}
\index{GetEditionIDFromREG@{GetEditionIDFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetEditionIDFromREG()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Edition\+IDFrom\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 23} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00024         \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}EditionID"{}}, \textcolor{stringliteral}{"{}"{}}); \}}

\end{DoxyCode}
\mbox{\label{a00336_a6f7b35001d26a19050d5bb1f9b2dff91}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetProductNameFromREG@{GetProductNameFromREG}}
\index{GetProductNameFromREG@{GetProductNameFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetProductNameFromREG()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Product\+Name\+From\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 29} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00030         \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}ProductName"{}}, \textcolor{stringliteral}{"{}"{}}); \}}

\end{DoxyCode}
\mbox{\label{a00336_a65fd25cbddb8c2f5c1554015bbe40e7c}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetReleaseIdFromREG@{GetReleaseIdFromREG}}
\index{GetReleaseIdFromREG@{GetReleaseIdFromREG}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetReleaseIdFromREG()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Release\+Id\+From\+REG (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 35} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00036         \{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{string})Registry.GetValue(\textcolor{stringliteral}{@"{}HKEY\_LOCAL\_MACHINE\(\backslash\)SOFTWARE\(\backslash\)Microsoft\(\backslash\)Windows NT\(\backslash\)CurrentVersion"{}}, \textcolor{stringliteral}{"{}ReleaseId"{}}, \textcolor{stringliteral}{"{}"{}}); \}}

\end{DoxyCode}
\mbox{\label{a00336_ae3960396bf3f945b760c9c32fbabfce0}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetScreen@{GetScreen}}
\index{GetScreen@{GetScreen}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetScreen()}
{\footnotesize\ttfamily static Memory\+Stream Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Screen (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 38} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00039         \{}
\DoxyCodeLine{00040             Bitmap BM = \textcolor{keyword}{new} Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height);}
\DoxyCodeLine{00041             Graphics GH = Graphics.FromImage(BM);}
\DoxyCodeLine{00042             GH.CopyFromScreen(0, 0, 0, 0, BM.Size);}
\DoxyCodeLine{00043             MemoryStream memoryStream = \textcolor{keyword}{new} MemoryStream();}
\DoxyCodeLine{00044             BM.Save(memoryStream, System.Drawing.Imaging.ImageFormat.Png);}
\DoxyCodeLine{00045             memoryStream.Position = 0;}
\DoxyCodeLine{00046             \textcolor{keywordflow}{return} memoryStream;}
\DoxyCodeLine{00047         \}}

\end{DoxyCode}
\mbox{\label{a00336_a8e0547311a160e8ff2842f66afbeca65}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!GetVersion@{GetVersion}}
\index{GetVersion@{GetVersion}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{GetVersion()}
{\footnotesize\ttfamily static string Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Get\+Version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 17} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00018         \{ \textcolor{keywordflow}{return} Convert.ToString(Environment.OSVersion.Version); \}}

\end{DoxyCode}
\mbox{\label{a00336_aa10471348dc8dbbf60839c1bb0347e65}} 
\index{VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}!Is64x@{Is64x}}
\index{Is64x@{Is64x}!VitNX.Functions.Windows.Information.Windows@{VitNX.Functions.Windows.Information.Windows}}
\doxysubsubsection{Is64x()}
{\footnotesize\ttfamily static bool Vit\+NX.\+Functions.\+Windows.\+Information.\+Windows.\+Is64x (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 14} of file \textbf{ Computer.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00015         \{ \textcolor{keywordflow}{return} Environment.Is64BitOperatingSystem; \}}

\end{DoxyCode}
