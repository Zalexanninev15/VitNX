\doxysection{Vit\+NX\+\_\+\+Progress\+Bar.\+cs}
\label{a00257_source}\index{E:/Github/VitNX/VitNX/UI/ControlsV1/VitNX\_ProgressBar.cs@{E:/Github/VitNX/VitNX/UI/ControlsV1/VitNX\_ProgressBar.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.ComponentModel;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} System.Drawing;}
\DoxyCodeLine{00004 \textcolor{keyword}{using} System.Windows.Forms;}
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{keyword}{namespace }VitNX.UI.ControlsV1}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00008     \textcolor{keyword}{public} \textcolor{keyword}{class }VitNX\_ProgressBar : ProgressBar}
\DoxyCodeLine{00009     \{}
\DoxyCodeLine{00010         [Description(\textcolor{stringliteral}{"{}Font of the text on ProgressBar"{}}), Category(\textcolor{stringliteral}{"{}Additional Options"{}})]}
\DoxyCodeLine{00011         \textcolor{keyword}{public} Font TextFont \{ \textcolor{keyword}{get}; \textcolor{keyword}{set}; \} = \textcolor{keyword}{new} Font(FontFamily.GenericSerif, 11, FontStyle.Bold);}
\DoxyCodeLine{00012 }
\DoxyCodeLine{00013         \textcolor{keyword}{private} SolidBrush \_textColourBrush = (SolidBrush)Brushes.Black;}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015         [Category(\textcolor{stringliteral}{"{}Additional Options"{}})]}
\DoxyCodeLine{00016         \textcolor{keyword}{public} Color TextColor}
\DoxyCodeLine{00017         \{}
\DoxyCodeLine{00018             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \_textColourBrush.Color; \} }
\DoxyCodeLine{00019             \textcolor{keyword}{set} }
\DoxyCodeLine{00020             \{}
\DoxyCodeLine{00021                 \_textColourBrush.Dispose();}
\DoxyCodeLine{00022                 \_textColourBrush = \textcolor{keyword}{new} SolidBrush(value);}
\DoxyCodeLine{00023             \} }
\DoxyCodeLine{00024         \}}
\DoxyCodeLine{00025 }
\DoxyCodeLine{00026         \textcolor{keyword}{private} SolidBrush \_progressColourBrush = (SolidBrush)Brushes.DodgerBlue;}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028         [Category(\textcolor{stringliteral}{"{}Additional Options"{}}), Browsable(\textcolor{keyword}{true}), EditorBrowsable(EditorBrowsableState.Always)]}
\DoxyCodeLine{00029         \textcolor{keyword}{public} Color ProgressColor}
\DoxyCodeLine{00030         \{ }
\DoxyCodeLine{00031             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \_progressColourBrush.Color; \} }
\DoxyCodeLine{00032             \textcolor{keyword}{set} }
\DoxyCodeLine{00033             \{}
\DoxyCodeLine{00034                 \_progressColourBrush.Dispose(); }
\DoxyCodeLine{00035                 \_progressColourBrush = \textcolor{keyword}{new} SolidBrush(value);}
\DoxyCodeLine{00036             \} }
\DoxyCodeLine{00037         \}}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039         \textcolor{keyword}{private} VitNX\_ProgressBarDisplayMode \_visualMode = VitNX\_ProgressBarDisplayMode.CurrProgress;}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041         [Category(\textcolor{stringliteral}{"{}Additional Options"{}}), Browsable(\textcolor{keyword}{true})]}
\DoxyCodeLine{00042         \textcolor{keyword}{public} VitNX\_ProgressBarDisplayMode VisualMode}
\DoxyCodeLine{00043         \{}
\DoxyCodeLine{00044             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \_visualMode; \}}
\DoxyCodeLine{00045             \textcolor{keyword}{set}}
\DoxyCodeLine{00046             \{}
\DoxyCodeLine{00047                 \_visualMode = value;}
\DoxyCodeLine{00048                 Invalidate(); }
\DoxyCodeLine{00049             \} }
\DoxyCodeLine{00050         \}}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_text = \textcolor{keywordtype}{string}.Empty;}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054         [Description(\textcolor{stringliteral}{"{}If it's empty, \% will be shown"{}}), Category(\textcolor{stringliteral}{"{}Additional Options"{}}), Browsable(\textcolor{keyword}{true}), EditorBrowsable(EditorBrowsableState.Always)]}
\DoxyCodeLine{00055         \textcolor{keyword}{public} \textcolor{keywordtype}{string} CustomText}
\DoxyCodeLine{00056         \{}
\DoxyCodeLine{00057             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \_text; \} }
\DoxyCodeLine{00058             \textcolor{keyword}{set}}
\DoxyCodeLine{00059             \{ }
\DoxyCodeLine{00060                 \_text = value;}
\DoxyCodeLine{00061                 Invalidate(); }
\DoxyCodeLine{00062             \} }
\DoxyCodeLine{00063         \}}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_textToDraw}
\DoxyCodeLine{00066         \{}
\DoxyCodeLine{00067             \textcolor{keyword}{get}}
\DoxyCodeLine{00068             \{}
\DoxyCodeLine{00069                 \textcolor{keywordtype}{string} text = CustomText;}
\DoxyCodeLine{00070                 \textcolor{keywordflow}{switch} (VisualMode)}
\DoxyCodeLine{00071                 \{}
\DoxyCodeLine{00072                     \textcolor{keywordflow}{case} VitNX\_ProgressBarDisplayMode.Percentage:}
\DoxyCodeLine{00073                         text = \_percentageStr;}
\DoxyCodeLine{00074                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076                     \textcolor{keywordflow}{case} VitNX\_ProgressBarDisplayMode.CurrProgress:}
\DoxyCodeLine{00077                         text = \_currProgressStr;}
\DoxyCodeLine{00078                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080                     \textcolor{keywordflow}{case} VitNX\_ProgressBarDisplayMode.TextAndCurrProgress:}
\DoxyCodeLine{00081                         text = \$\textcolor{stringliteral}{"{}\{CustomText\}: \{\_currProgressStr\}"{}};}
\DoxyCodeLine{00082                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084                     \textcolor{keywordflow}{case} VitNX\_ProgressBarDisplayMode.TextAndPercentage:}
\DoxyCodeLine{00085                         text = \$\textcolor{stringliteral}{"{}\{CustomText\}: \{\_percentageStr\}"{}};}
\DoxyCodeLine{00086                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00087                 \}}
\DoxyCodeLine{00088                 \textcolor{keywordflow}{return} text;}
\DoxyCodeLine{00089             \}}
\DoxyCodeLine{00090             \textcolor{keyword}{set} \{ \}}
\DoxyCodeLine{00091         \}}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093         \textcolor{keyword}{public} VitNX\_ProgressBar()}
\DoxyCodeLine{00094         \{}
\DoxyCodeLine{00095             Value = Minimum; FixComponentBlinking();}
\DoxyCodeLine{00096         \}}
\DoxyCodeLine{00097 }
\DoxyCodeLine{00098         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_currProgressStr}
\DoxyCodeLine{00099         \{}
\DoxyCodeLine{00100             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \$\textcolor{stringliteral}{"{}\{Value\}/\{Maximum\}"{}}; \} }
\DoxyCodeLine{00101         \}}
\DoxyCodeLine{00102 }
\DoxyCodeLine{00103         \textcolor{keyword}{private} \textcolor{keywordtype}{void} FixComponentBlinking()}
\DoxyCodeLine{00104         \{}
\DoxyCodeLine{00105             SetStyle(ControlStyles.UserPaint | ControlStyles.AllPaintingInWmPaint | ControlStyles.OptimizedDoubleBuffer, \textcolor{keyword}{true});}
\DoxyCodeLine{00106         \}}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_percentageStr}
\DoxyCodeLine{00109         \{}
\DoxyCodeLine{00110             \textcolor{keyword}{get} \{}
\DoxyCodeLine{00111                 \textcolor{keywordflow}{return} \$\textcolor{stringliteral}{"{}\{(int)((float)Value -\/ Minimum) / ((float)Maximum -\/ Minimum) * 100 \} \%"{}};}
\DoxyCodeLine{00112             \} }
\DoxyCodeLine{00113         \}}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115         \textcolor{keyword}{protected} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnPaint(PaintEventArgs e)}
\DoxyCodeLine{00116         \{ }
\DoxyCodeLine{00117             Graphics g = e.Graphics; DrawProgressBar(g); DrawStringIfNeeded(g);}
\DoxyCodeLine{00118         \}}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120         \textcolor{keyword}{private} \textcolor{keywordtype}{void} DrawProgressBar(Graphics g)}
\DoxyCodeLine{00121         \{}
\DoxyCodeLine{00122             Rectangle rect = ClientRectangle;}
\DoxyCodeLine{00123             ProgressBarRenderer.DrawHorizontalBar(g, rect);}
\DoxyCodeLine{00124             \textcolor{keywordflow}{if} (Value > 0)}
\DoxyCodeLine{00125             \{ }
\DoxyCodeLine{00126                 Rectangle clip = \textcolor{keyword}{new} Rectangle(rect.X, rect.Y, (\textcolor{keywordtype}{int})Math.Round((\textcolor{keywordtype}{float})Value / Maximum * rect.Width), rect.Height);}
\DoxyCodeLine{00127                 g.FillRectangle(\_progressColourBrush, clip);}
\DoxyCodeLine{00128             \}}
\DoxyCodeLine{00129         \}}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131         \textcolor{keyword}{private} \textcolor{keywordtype}{void} DrawStringIfNeeded(Graphics g)}
\DoxyCodeLine{00132         \{}
\DoxyCodeLine{00133             \textcolor{keywordflow}{if} (VisualMode != VitNX\_ProgressBarDisplayMode.NoText)}
\DoxyCodeLine{00134             \{}
\DoxyCodeLine{00135                 \textcolor{keywordtype}{string} text = \_textToDraw;}
\DoxyCodeLine{00136                 SizeF len = g.MeasureString(text, TextFont);}
\DoxyCodeLine{00137                 Point location = \textcolor{keyword}{new} Point((Width / 2) -\/ (\textcolor{keywordtype}{int})len.Width / 2, (Height / 2) -\/ (\textcolor{keywordtype}{int})len.Height / 2);}
\DoxyCodeLine{00138                 g.DrawString(text, TextFont, \_textColourBrush, location);}
\DoxyCodeLine{00139             \}}
\DoxyCodeLine{00140         \}}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{void} Dispose()}
\DoxyCodeLine{00143         \{}
\DoxyCodeLine{00144             \_textColourBrush.Dispose(); \_progressColourBrush.Dispose();}
\DoxyCodeLine{00145             base.Dispose();}
\DoxyCodeLine{00146         \}}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148         \textcolor{keyword}{private} \textcolor{keywordtype}{void} InitializeComponent()}
\DoxyCodeLine{00149         \{}
\DoxyCodeLine{00150             SuspendLayout(); }
\DoxyCodeLine{00151             BackColor = Color.FromArgb(69, 73, 74); }
\DoxyCodeLine{00152             ResumeLayout(\textcolor{keyword}{false}); }
\DoxyCodeLine{00153         \}}
\DoxyCodeLine{00154     \}}
\DoxyCodeLine{00155 \}}

\end{DoxyCode}
