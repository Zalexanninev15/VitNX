\doxysection{Power\+Control.\+cs}
\label{a00008_source}\index{E:/Github/VitNX/VitNX/Functions/Common/PowerControl.cs@{E:/Github/VitNX/VitNX/Functions/Common/PowerControl.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.Diagnostics;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} System.Windows.Forms;}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{keyword}{namespace }VitNX.Functions.Common}
\DoxyCodeLine{00006 \{}
\DoxyCodeLine{00007     \textcolor{keyword}{public} \textcolor{keyword}{class }Power}
\DoxyCodeLine{00008     \{}
\DoxyCodeLine{00009         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} ComputerPowerControl(Windows.Win32.Enums.SYSTEM\_POWER\_CONTROL method)}
\DoxyCodeLine{00010         \{}
\DoxyCodeLine{00011             \textcolor{keywordflow}{switch} (method)}
\DoxyCodeLine{00012             \{}
\DoxyCodeLine{00013                 \textcolor{keywordflow}{case} Windows.Win32.Enums.SYSTEM\_POWER\_CONTROL.SYSTEM\_LOGOFF:}
\DoxyCodeLine{00014                     \{}
\DoxyCodeLine{00015                         Windows.Win32.Import.ExitWindowsEx(0, 0);}
\DoxyCodeLine{00016                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00017                     \}}
\DoxyCodeLine{00018                 \textcolor{keywordflow}{case} Windows.Win32.Enums.SYSTEM\_POWER\_CONTROL.SYSTEM\_SHUTDOWN:}
\DoxyCodeLine{00019                     \{}
\DoxyCodeLine{00020                         Process.Start(\textcolor{stringliteral}{"{}shutdown"{}}, \textcolor{stringliteral}{"{}/s /t 0"{}});}
\DoxyCodeLine{00021                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00022                     \}}
\DoxyCodeLine{00023                 \textcolor{keywordflow}{case} Windows.Win32.Enums.SYSTEM\_POWER\_CONTROL.SYSTEM\_REBOOT:}
\DoxyCodeLine{00024                     \{}
\DoxyCodeLine{00025                         Process.Start(\textcolor{stringliteral}{"{}shutdown"{}}, \textcolor{stringliteral}{"{}/r /t 0"{}});}
\DoxyCodeLine{00026                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00027                     \}}
\DoxyCodeLine{00028                 \textcolor{keywordflow}{case} Windows.Win32.Enums.SYSTEM\_POWER\_CONTROL.SYSTEM\_LOCK:}
\DoxyCodeLine{00029                     \{}
\DoxyCodeLine{00030                         Windows.Win32.Import.LockWorkStation();}
\DoxyCodeLine{00031                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00032                     \}}
\DoxyCodeLine{00033             \}}
\DoxyCodeLine{00034         \}}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MonitorPowerControl(\textcolor{keywordtype}{bool} worked)}
\DoxyCodeLine{00037         \{}
\DoxyCodeLine{00038             Form frm = \textcolor{keyword}{new} Form();}
\DoxyCodeLine{00039             \textcolor{keywordflow}{if} (worked)}
\DoxyCodeLine{00040             \{}
\DoxyCodeLine{00041                 Windows.Win32.Import.mouse\_event(Windows.Win32.Constants.MOUSEEVENTF\_MOVE, 0, 1, 0, UIntPtr.Zero);}
\DoxyCodeLine{00042                 frm.Close();}
\DoxyCodeLine{00043             \}}
\DoxyCodeLine{00044             \textcolor{keywordflow}{else} Windows.Win32.Import.SendMessage(frm.Handle,}
\DoxyCodeLine{00045                 Windows.Win32.Constants.WM\_SYSCOMMAND,}
\DoxyCodeLine{00046                 (IntPtr)Windows.Win32.Constants.SC\_MONITORPOWER,}
\DoxyCodeLine{00047                 (IntPtr)2);}
\DoxyCodeLine{00048         \}}
\DoxyCodeLine{00049     \}}
\DoxyCodeLine{00050 \}}

\end{DoxyCode}
