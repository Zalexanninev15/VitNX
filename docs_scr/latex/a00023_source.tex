\doxysection{Native\+Controls.\+cs}
\label{a00023_source}\index{E:/Github/VitNX/VitNX/Functions/Windows/NativeControls.cs@{E:/Github/VitNX/VitNX/Functions/Windows/NativeControls.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.Reflection;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} System.Runtime.InteropServices;}
\DoxyCodeLine{00004 \textcolor{keyword}{using} System.Threading;}
\DoxyCodeLine{00005 \textcolor{keyword}{using} System.Threading.Tasks;}
\DoxyCodeLine{00006 \textcolor{keyword}{using} System.Windows.Forms;}
\DoxyCodeLine{00007 \textcolor{keyword}{using} VitNX.Functions.Windows.Win32;}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keyword}{namespace }VitNX.Functions.Windows.NativeControls}
\DoxyCodeLine{00010 \{}
\DoxyCodeLine{00011     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{class }TaskBarProgressBar}
\DoxyCodeLine{00012     \{}
\DoxyCodeLine{00013         [ComImport()]}
\DoxyCodeLine{00014         [Guid(\textcolor{stringliteral}{"{}ea1afb91-\/9e28-\/4b86-\/90e9-\/9e9f8a5eefaf"{}})]}
\DoxyCodeLine{00015         [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]}
\DoxyCodeLine{00016         \textcolor{keyword}{private} \textcolor{keyword}{interface }ITaskbarList3}
\DoxyCodeLine{00017         \{}
\DoxyCodeLine{00018             [PreserveSig]}
\DoxyCodeLine{00019             \textcolor{keywordtype}{void} HrInit();}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021             [PreserveSig]}
\DoxyCodeLine{00022             \textcolor{keywordtype}{void} AddTab(IntPtr hwnd);}
\DoxyCodeLine{00023 }
\DoxyCodeLine{00024             [PreserveSig]}
\DoxyCodeLine{00025             \textcolor{keywordtype}{void} DeleteTab(IntPtr hwnd);}
\DoxyCodeLine{00026 }
\DoxyCodeLine{00027             [PreserveSig]}
\DoxyCodeLine{00028             \textcolor{keywordtype}{void} ActivateTab(IntPtr hwnd);}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030             [PreserveSig]}
\DoxyCodeLine{00031             \textcolor{keywordtype}{void} SetActiveAlt(IntPtr hwnd);}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033             [PreserveSig]}
\DoxyCodeLine{00034             \textcolor{keywordtype}{void} MarkFullscreenWindow(IntPtr hwnd, [MarshalAs(UnmanagedType.Bool)] \textcolor{keywordtype}{bool} fFullscreen);}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036             [PreserveSig]}
\DoxyCodeLine{00037             \textcolor{keywordtype}{void} SetProgressValue(IntPtr hwnd, UInt64 ullCompleted, UInt64 ullTotal);}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039             [PreserveSig]}
\DoxyCodeLine{00040             \textcolor{keywordtype}{void} SetProgressState(IntPtr hwnd, Enums.TASKBAR\_STATES state);}
\DoxyCodeLine{00041         \}}
\DoxyCodeLine{00042 }
\DoxyCodeLine{00043         [ComImport()]}
\DoxyCodeLine{00044         [Guid(\textcolor{stringliteral}{"{}56fdf344-\/fd6d-\/11d0-\/958a-\/006097c9a090"{}})]}
\DoxyCodeLine{00045         [ClassInterface(ClassInterfaceType.None)]}
\DoxyCodeLine{00046         \textcolor{keyword}{private} \textcolor{keyword}{class }TaskbarInstance}
\DoxyCodeLine{00047         \{ \}}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049         \textcolor{keyword}{private} \textcolor{keyword}{static} ITaskbarList3 taskbarInstance = (ITaskbarList3)\textcolor{keyword}{new} TaskbarInstance();}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} taskbarSupported = Environment.OSVersion.Version >= \textcolor{keyword}{new} Version(6, 1);}
\DoxyCodeLine{00052 }
\DoxyCodeLine{00053         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetState(IntPtr windowHandle,}
\DoxyCodeLine{00054             Enums.TASKBAR\_STATES taskbarState)}
\DoxyCodeLine{00055         \{}
\DoxyCodeLine{00056             \textcolor{keywordflow}{if} (taskbarSupported)}
\DoxyCodeLine{00057                 taskbarInstance.SetProgressState(windowHandle, taskbarState);}
\DoxyCodeLine{00058         \}}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetValue(IntPtr windowHandle,}
\DoxyCodeLine{00061             \textcolor{keywordtype}{double} Value,}
\DoxyCodeLine{00062             \textcolor{keywordtype}{double} Max)}
\DoxyCodeLine{00063         \{}
\DoxyCodeLine{00064             \textcolor{keywordflow}{if} (taskbarSupported)}
\DoxyCodeLine{00065                 taskbarInstance.SetProgressValue(windowHandle, (ulong)Value, (ulong)Max);}
\DoxyCodeLine{00066         \}}
\DoxyCodeLine{00067     \}}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069     \textcolor{keyword}{public} \textcolor{keyword}{class }NewFolderDialog}
\DoxyCodeLine{00070     \{}
\DoxyCodeLine{00071         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_initialDirectory;}
\DoxyCodeLine{00072         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_title;}
\DoxyCodeLine{00073         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_fileName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075         \textcolor{keyword}{public} \textcolor{keywordtype}{string} InitialDirectory}
\DoxyCodeLine{00076         \{}
\DoxyCodeLine{00077             \textcolor{keyword}{get}}
\DoxyCodeLine{00078             \{}
\DoxyCodeLine{00079                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{string}.IsNullOrEmpty(\_initialDirectory) ? Environment.CurrentDirectory : \_initialDirectory;}
\DoxyCodeLine{00080             \}}
\DoxyCodeLine{00081             \textcolor{keyword}{set}}
\DoxyCodeLine{00082             \{}
\DoxyCodeLine{00083                 \_initialDirectory = value;}
\DoxyCodeLine{00084             \}}
\DoxyCodeLine{00085         \}}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087         \textcolor{keyword}{public} \textcolor{keywordtype}{string} Title}
\DoxyCodeLine{00088         \{}
\DoxyCodeLine{00089             \textcolor{keyword}{get}}
\DoxyCodeLine{00090             \{}
\DoxyCodeLine{00091                 \textcolor{keywordflow}{return} \_title ?? \textcolor{stringliteral}{"{}Select a folder"{}};}
\DoxyCodeLine{00092             \}}
\DoxyCodeLine{00093             \textcolor{keyword}{set}}
\DoxyCodeLine{00094             \{}
\DoxyCodeLine{00095                 \_title = value;}
\DoxyCodeLine{00096             \}}
\DoxyCodeLine{00097         \}}
\DoxyCodeLine{00098 }
\DoxyCodeLine{00099         \textcolor{keyword}{public} \textcolor{keywordtype}{string} FileName}
\DoxyCodeLine{00100         \{}
\DoxyCodeLine{00101             \textcolor{keyword}{get}}
\DoxyCodeLine{00102             \{}
\DoxyCodeLine{00103                 \textcolor{keywordflow}{return} \_fileName;}
\DoxyCodeLine{00104             \}}
\DoxyCodeLine{00105         \}}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} Show()}
\DoxyCodeLine{00108         \{ \textcolor{keywordflow}{return} Show(IntPtr.Zero); \}}
\DoxyCodeLine{00109 }
\DoxyCodeLine{00110         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} Show(IntPtr hWndOwner)}
\DoxyCodeLine{00111         \{}
\DoxyCodeLine{00112             var result = Environment.OSVersion.Version.Major >= 6 ? ModernDialog.Show(hWndOwner, InitialDirectory, Title) : ShowXpDialog(hWndOwner, InitialDirectory, Title);}
\DoxyCodeLine{00113             \_fileName = result.FileName;}
\DoxyCodeLine{00114             \textcolor{keywordflow}{return} result.Result;}
\DoxyCodeLine{00115         \}}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117         \textcolor{keyword}{private} \textcolor{keyword}{struct }ShowDialogResult}
\DoxyCodeLine{00118         \{}
\DoxyCodeLine{00119             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} Result \{ \textcolor{keyword}{get}; \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00120             \textcolor{keyword}{public} \textcolor{keywordtype}{string} FileName \{ \textcolor{keyword}{get}; \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00121         \}}
\DoxyCodeLine{00122 }
\DoxyCodeLine{00123         \textcolor{keyword}{private} \textcolor{keyword}{static} ShowDialogResult ShowXpDialog(IntPtr ownerHandle,}
\DoxyCodeLine{00124             \textcolor{keywordtype}{string} initialDirectory,}
\DoxyCodeLine{00125             \textcolor{keywordtype}{string} title)}
\DoxyCodeLine{00126         \{}
\DoxyCodeLine{00127             var folderBrowserDialog = \textcolor{keyword}{new} FolderBrowserDialog}
\DoxyCodeLine{00128             \{ Description = title, SelectedPath = initialDirectory, ShowNewFolderButton = \textcolor{keyword}{false} \};}
\DoxyCodeLine{00129             var dialogResult = \textcolor{keyword}{new} ShowDialogResult();}
\DoxyCodeLine{00130             \textcolor{keywordflow}{if} (folderBrowserDialog.ShowDialog(\textcolor{keyword}{new} WindowWrapper(ownerHandle)) == DialogResult.OK)}
\DoxyCodeLine{00131             \{}
\DoxyCodeLine{00132                 dialogResult.Result = \textcolor{keyword}{true};}
\DoxyCodeLine{00133                 dialogResult.FileName = folderBrowserDialog.SelectedPath;}
\DoxyCodeLine{00134             \}}
\DoxyCodeLine{00135             \textcolor{keywordflow}{return} dialogResult;}
\DoxyCodeLine{00136         \}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{class }ModernDialog}
\DoxyCodeLine{00139         \{}
\DoxyCodeLine{00140             \textcolor{keyword}{private} \textcolor{keyword}{const} \textcolor{keywordtype}{string} c\_foldersFilter = \textcolor{stringliteral}{"{}Folders|\(\backslash\)n"{}};}
\DoxyCodeLine{00141             \textcolor{keyword}{private} \textcolor{keyword}{const} BindingFlags c\_flags = BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic;}
\DoxyCodeLine{00142             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly Assembly s\_windowsFormsAssembly = typeof(FileDialog).Assembly;}
\DoxyCodeLine{00143             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly Type s\_iFileDialogType = s\_windowsFormsAssembly.GetType(\textcolor{stringliteral}{"{}System.Windows.Forms.FileDialogNative+IFileDialog"{}});}
\DoxyCodeLine{00144             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_createVistaDialogMethodInfo = typeof(OpenFileDialog).GetMethod(\textcolor{stringliteral}{"{}CreateVistaDialog"{}}, c\_flags);}
\DoxyCodeLine{00145             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_onBeforeVistaDialogMethodInfo = typeof(OpenFileDialog).GetMethod(\textcolor{stringliteral}{"{}OnBeforeVistaDialog"{}}, c\_flags);}
\DoxyCodeLine{00146             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_getOptionsMethodInfo = typeof(FileDialog).GetMethod(\textcolor{stringliteral}{"{}GetOptions"{}}, c\_flags);}
\DoxyCodeLine{00147             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_setOptionsMethodInfo = s\_iFileDialogType.GetMethod(\textcolor{stringliteral}{"{}SetOptions"{}}, c\_flags);}
\DoxyCodeLine{00148             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly uint s\_fosPickFoldersBitFlag = (uint)s\_windowsFormsAssembly.GetType(\textcolor{stringliteral}{"{}System.Windows.Forms.FileDialogNative+FOS"{}}).GetField(\textcolor{stringliteral}{"{}FOS\_PICKFOLDERS"{}}).GetValue(\textcolor{keyword}{null});}
\DoxyCodeLine{00149             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly ConstructorInfo s\_VistaDialogEventsConstructorInfo = s\_windowsFormsAssembly.GetType(\textcolor{stringliteral}{"{}System.Windows.Forms.FileDialog+VistaDialogEvents"{}}).GetConstructor(c\_flags, \textcolor{keyword}{null}, \textcolor{keyword}{new}[] \{ typeof(FileDialog) \}, \textcolor{keyword}{null});}
\DoxyCodeLine{00150             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_adviseMethodInfo = s\_iFileDialogType.GetMethod(\textcolor{stringliteral}{"{}Advise"{}});}
\DoxyCodeLine{00151             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_unAdviseMethodInfo = s\_iFileDialogType.GetMethod(\textcolor{stringliteral}{"{}Unadvise"{}});}
\DoxyCodeLine{00152             \textcolor{keyword}{private} \textcolor{keyword}{static} readonly MethodInfo s\_showMethodInfo = s\_iFileDialogType.GetMethod(\textcolor{stringliteral}{"{}Show"{}});}
\DoxyCodeLine{00153 }
\DoxyCodeLine{00154             \textcolor{keyword}{public} \textcolor{keyword}{static} ShowDialogResult Show(IntPtr ownerHandle, \textcolor{keywordtype}{string} initialDirectory, \textcolor{keywordtype}{string} title)}
\DoxyCodeLine{00155             \{}
\DoxyCodeLine{00156                 var openFileDialog = \textcolor{keyword}{new} OpenFileDialog}
\DoxyCodeLine{00157                 \{}
\DoxyCodeLine{00158                     AddExtension = \textcolor{keyword}{false},}
\DoxyCodeLine{00159                     CheckFileExists = \textcolor{keyword}{false},}
\DoxyCodeLine{00160                     DereferenceLinks = \textcolor{keyword}{true},}
\DoxyCodeLine{00161                     Filter = c\_foldersFilter,}
\DoxyCodeLine{00162                     InitialDirectory = initialDirectory,}
\DoxyCodeLine{00163                     Multiselect = \textcolor{keyword}{false},}
\DoxyCodeLine{00164                     Title = title}
\DoxyCodeLine{00165                 \};}
\DoxyCodeLine{00166                 var iFileDialog = s\_createVistaDialogMethodInfo.Invoke(openFileDialog, \textcolor{keyword}{new} \textcolor{keywordtype}{object}[] \{ \});}
\DoxyCodeLine{00167                 s\_onBeforeVistaDialogMethodInfo.Invoke(openFileDialog, \textcolor{keyword}{new}[] \{ iFileDialog \});}
\DoxyCodeLine{00168                 s\_setOptionsMethodInfo.Invoke(iFileDialog, \textcolor{keyword}{new} \textcolor{keywordtype}{object}[] \{ (uint)s\_getOptionsMethodInfo.Invoke(openFileDialog, \textcolor{keyword}{new} \textcolor{keywordtype}{object}[] \{ \}) | s\_fosPickFoldersBitFlag \});}
\DoxyCodeLine{00169                 var adviseParametersWithOutputConnectionToken = \textcolor{keyword}{new}[] \{ s\_VistaDialogEventsConstructorInfo.Invoke(\textcolor{keyword}{new} \textcolor{keywordtype}{object}[] \{ openFileDialog \}), 0U \};}
\DoxyCodeLine{00170                 s\_adviseMethodInfo.Invoke(iFileDialog, adviseParametersWithOutputConnectionToken);}
\DoxyCodeLine{00171                 \textcolor{keywordflow}{try}}
\DoxyCodeLine{00172                 \{}
\DoxyCodeLine{00173                     \textcolor{keywordtype}{int} retVal = (int)s\_showMethodInfo.Invoke(iFileDialog, \textcolor{keyword}{new} \textcolor{keywordtype}{object}[] \{ ownerHandle \});}
\DoxyCodeLine{00174                     \textcolor{keywordflow}{return} \textcolor{keyword}{new} ShowDialogResult \{ Result = retVal == 0, FileName = openFileDialog.FileName \};}
\DoxyCodeLine{00175                 \}}
\DoxyCodeLine{00176                 \textcolor{keywordflow}{finally} \{ s\_unAdviseMethodInfo.Invoke(iFileDialog, \textcolor{keyword}{new}[] \{ adviseParametersWithOutputConnectionToken[1] \}); \}}
\DoxyCodeLine{00177             \}}
\DoxyCodeLine{00178         \}}
\DoxyCodeLine{00179 }
\DoxyCodeLine{00180         \textcolor{keyword}{private} \textcolor{keyword}{class }WindowWrapper : IWin32Window}
\DoxyCodeLine{00181         \{}
\DoxyCodeLine{00182             \textcolor{keyword}{private} readonly IntPtr \_handle;}
\DoxyCodeLine{00183 }
\DoxyCodeLine{00184             \textcolor{keyword}{public} WindowWrapper(IntPtr handle)}
\DoxyCodeLine{00185             \{ \_handle = handle; \}}
\DoxyCodeLine{00186 }
\DoxyCodeLine{00187             \textcolor{keyword}{public} IntPtr Handle}
\DoxyCodeLine{00188             \{}
\DoxyCodeLine{00189                 \textcolor{keyword}{get}}
\DoxyCodeLine{00190                 \{}
\DoxyCodeLine{00191                     \textcolor{keywordflow}{return} \_handle;}
\DoxyCodeLine{00192                 \}}
\DoxyCodeLine{00193             \}}
\DoxyCodeLine{00194         \}}
\DoxyCodeLine{00195     \}}
\DoxyCodeLine{00196 }
\DoxyCodeLine{00197     \textcolor{keyword}{public} \textcolor{keyword}{class }VolumeControl}
\DoxyCodeLine{00198     \{}
\DoxyCodeLine{00199         [ComImport]}
\DoxyCodeLine{00200         [Guid(\textcolor{stringliteral}{"{}BCDE0395-\/E52F-\/467C-\/8E3D-\/C4579291692E"{}})]}
\DoxyCodeLine{00201         \textcolor{keyword}{internal} \textcolor{keyword}{class }MMDeviceEnumerator}
\DoxyCodeLine{00202         \{ \}}
\DoxyCodeLine{00203 }
\DoxyCodeLine{00204         [Guid(\textcolor{stringliteral}{"{}A95664D2-\/9614-\/4F35-\/A746-\/DE8DB63617E6"{}}), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]}
\DoxyCodeLine{00205         \textcolor{keyword}{internal} \textcolor{keyword}{interface }IMMDeviceEnumerator}
\DoxyCodeLine{00206         \{}
\DoxyCodeLine{00207             \textcolor{keywordtype}{int} NotImpl1();}
\DoxyCodeLine{00208 }
\DoxyCodeLine{00209             [PreserveSig]}
\DoxyCodeLine{00210             \textcolor{keywordtype}{int} GetDefaultAudioEndpoint(Enums.E\_DATA\_FLOW dataFlow,}
\DoxyCodeLine{00211                 Enums.E\_ROLE role,}
\DoxyCodeLine{00212                 out IMMDevice ppDevice);}
\DoxyCodeLine{00213         \}}
\DoxyCodeLine{00214 }
\DoxyCodeLine{00215         [Guid(\textcolor{stringliteral}{"{}D666063F-\/1587-\/4E43-\/81F1-\/B948E807363F"{}}), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]}
\DoxyCodeLine{00216         \textcolor{keyword}{internal} \textcolor{keyword}{interface }IMMDevice}
\DoxyCodeLine{00217         \{}
\DoxyCodeLine{00218             [PreserveSig]}
\DoxyCodeLine{00219             \textcolor{keywordtype}{int} Activate(ref Guid iid,}
\DoxyCodeLine{00220                 \textcolor{keywordtype}{int} dwClsCtx,}
\DoxyCodeLine{00221                 IntPtr pActivationParams,}
\DoxyCodeLine{00222                 [MarshalAs(UnmanagedType.IUnknown)] out \textcolor{keywordtype}{object} ppInterface);}
\DoxyCodeLine{00223         \}}
\DoxyCodeLine{00224 }
\DoxyCodeLine{00225         [Guid(\textcolor{stringliteral}{"{}657804FA-\/D6AD-\/4496-\/8A60-\/352752AF4F89"{}}), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]}
\DoxyCodeLine{00226         \textcolor{keyword}{internal} \textcolor{keyword}{interface }IAudioEndpointVolumeCallback}
\DoxyCodeLine{00227         \{}
\DoxyCodeLine{00228             \textcolor{keywordtype}{int} OnNotify(IntPtr pNotifyData);}
\DoxyCodeLine{00229         \};}
\DoxyCodeLine{00230 }
\DoxyCodeLine{00231         [Guid(\textcolor{stringliteral}{"{}5CDF2C82-\/841E-\/4546-\/9722-\/0CF74078229A"{}}), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]}
\DoxyCodeLine{00232         \textcolor{keyword}{internal} \textcolor{keyword}{interface }IAudioEndpointVolume}
\DoxyCodeLine{00233         \{}
\DoxyCodeLine{00234             \textcolor{keywordtype}{int} RegisterControlChangeNotify(IAudioEndpointVolumeCallback pNotify);}
\DoxyCodeLine{00235 }
\DoxyCodeLine{00236             \textcolor{keywordtype}{int} UnregisterControlChangeNotify(IAudioEndpointVolumeCallback pNotify);}
\DoxyCodeLine{00237 }
\DoxyCodeLine{00238             \textcolor{keywordtype}{int} GetChannelCount(out \textcolor{keywordtype}{int} pnChannelCount);}
\DoxyCodeLine{00239 }
\DoxyCodeLine{00240             \textcolor{keywordtype}{int} SetMasterVolumeLevel(\textcolor{keywordtype}{float} fLevelDB, Guid pguidEventContext);}
\DoxyCodeLine{00241 }
\DoxyCodeLine{00242             \textcolor{keywordtype}{int} SetMasterVolumeLevelScalar(\textcolor{keywordtype}{float} fLevel, Guid pguidEventContext);}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244             \textcolor{keywordtype}{int} GetMasterVolumeLevel(out \textcolor{keywordtype}{float} pfLevelDB);}
\DoxyCodeLine{00245 }
\DoxyCodeLine{00246             \textcolor{keywordtype}{int} GetMasterVolumeLevelScalar(out \textcolor{keywordtype}{float} pfLevel);}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248             \textcolor{keywordtype}{int} SetChannelVolumeLevel(uint nChannel, \textcolor{keywordtype}{float} fLevelDB, Guid pguidEventContext);}
\DoxyCodeLine{00249 }
\DoxyCodeLine{00250             \textcolor{keywordtype}{int} SetChannelVolumeLevelScalar(uint nChannel, \textcolor{keywordtype}{float} fLevel, Guid pguidEventContext);}
\DoxyCodeLine{00251 }
\DoxyCodeLine{00252             \textcolor{keywordtype}{int} GetChannelVolumeLevel(uint nChannel, out \textcolor{keywordtype}{float} pfLevelDB);}
\DoxyCodeLine{00253 }
\DoxyCodeLine{00254             \textcolor{keywordtype}{int} GetChannelVolumeLevelScalar(uint nChannel, out \textcolor{keywordtype}{float} pfLevel);}
\DoxyCodeLine{00255 }
\DoxyCodeLine{00256             \textcolor{keywordtype}{int} SetMute([MarshalAs(UnmanagedType.Bool)] \textcolor{keywordtype}{bool} bMute, Guid pguidEventContext);}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00258             \textcolor{keywordtype}{int} GetMute(out \textcolor{keywordtype}{bool} pbMute);}
\DoxyCodeLine{00259 }
\DoxyCodeLine{00260             \textcolor{keywordtype}{int} GetVolumeStepInfo(out uint pnStep, out uint pnStepCount);}
\DoxyCodeLine{00261 }
\DoxyCodeLine{00262             \textcolor{keywordtype}{int} VolumeStepUp(Guid pguidEventContext);}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264             \textcolor{keywordtype}{int} VolumeStepDown(Guid pguidEventContext);}
\DoxyCodeLine{00265 }
\DoxyCodeLine{00266             \textcolor{keywordtype}{int} QueryHardwareSupport(out uint pdwHardwareSupportMask);}
\DoxyCodeLine{00267 }
\DoxyCodeLine{00268             \textcolor{keywordtype}{int} GetVolumeRange(out \textcolor{keywordtype}{float} pflVolumeMindB, out \textcolor{keywordtype}{float} pflVolumeMaxdB, out \textcolor{keywordtype}{float} pflVolumeIncrementdB);}
\DoxyCodeLine{00269         \}}
\DoxyCodeLine{00270 }
\DoxyCodeLine{00271         \textcolor{keyword}{public} \textcolor{keywordtype}{void} Set(\textcolor{keywordtype}{float} level)}
\DoxyCodeLine{00272         \{}
\DoxyCodeLine{00273             IMMDeviceEnumerator deviceEnumerator = (IMMDeviceEnumerator)\textcolor{keyword}{new} MMDeviceEnumerator();}
\DoxyCodeLine{00274             IMMDevice speakers = \textcolor{keyword}{null};}
\DoxyCodeLine{00275             IAudioEndpointVolume vol = \textcolor{keyword}{null};}
\DoxyCodeLine{00276             deviceEnumerator.GetDefaultAudioEndpoint(Enums.E\_DATA\_FLOW.eRender,}
\DoxyCodeLine{00277                 Enums.E\_ROLE.eMultimedia,}
\DoxyCodeLine{00278                 out speakers);}
\DoxyCodeLine{00279             Guid IID\_IAudioEndpointVolume = typeof(IAudioEndpointVolume).GUID;}
\DoxyCodeLine{00280             speakers.Activate(ref IID\_IAudioEndpointVolume,}
\DoxyCodeLine{00281                 0,}
\DoxyCodeLine{00282                 IntPtr.Zero,}
\DoxyCodeLine{00283                 out \textcolor{keywordtype}{object} o);}
\DoxyCodeLine{00284             vol = (IAudioEndpointVolume)o;}
\DoxyCodeLine{00285             vol.SetMasterVolumeLevelScalar(level, Guid.Empty);}
\DoxyCodeLine{00286             \textcolor{keywordflow}{if} (vol != \textcolor{keyword}{null}) Marshal.ReleaseComObject(vol);}
\DoxyCodeLine{00287             \textcolor{keywordflow}{if} (speakers != \textcolor{keyword}{null}) Marshal.ReleaseComObject(speakers);}
\DoxyCodeLine{00288             \textcolor{keywordflow}{if} (deviceEnumerator != \textcolor{keyword}{null}) Marshal.ReleaseComObject(deviceEnumerator);}
\DoxyCodeLine{00289         \}}
\DoxyCodeLine{00290 }
\DoxyCodeLine{00291         \textcolor{keyword}{public} \textcolor{keywordtype}{float} Get()}
\DoxyCodeLine{00292         \{}
\DoxyCodeLine{00293             IMMDeviceEnumerator deviceEnumerator = (IMMDeviceEnumerator)\textcolor{keyword}{new} MMDeviceEnumerator();}
\DoxyCodeLine{00294             IMMDevice speakers = \textcolor{keyword}{null};}
\DoxyCodeLine{00295             IAudioEndpointVolume vol = \textcolor{keyword}{null};}
\DoxyCodeLine{00296             deviceEnumerator.GetDefaultAudioEndpoint(Enums.E\_DATA\_FLOW.eRender,}
\DoxyCodeLine{00297                 Enums.E\_ROLE.eMultimedia,}
\DoxyCodeLine{00298                 out speakers);}
\DoxyCodeLine{00299             Guid IID\_IAudioEndpointVolume = typeof(IAudioEndpointVolume).GUID;}
\DoxyCodeLine{00300             speakers.Activate(ref IID\_IAudioEndpointVolume, 0, IntPtr.Zero, out \textcolor{keywordtype}{object} o);}
\DoxyCodeLine{00301             vol = (IAudioEndpointVolume)o;}
\DoxyCodeLine{00302             \textcolor{keywordtype}{float} currentVolume = 0;}
\DoxyCodeLine{00303             vol.GetMasterVolumeLevelScalar(out currentVolume);}
\DoxyCodeLine{00304             \textcolor{keywordflow}{if} (vol != \textcolor{keyword}{null}) Marshal.ReleaseComObject(vol);}
\DoxyCodeLine{00305             \textcolor{keywordflow}{if} (speakers != \textcolor{keyword}{null}) Marshal.ReleaseComObject(speakers);}
\DoxyCodeLine{00306             \textcolor{keywordflow}{if} (deviceEnumerator != \textcolor{keyword}{null}) Marshal.ReleaseComObject(deviceEnumerator);}
\DoxyCodeLine{00307             \textcolor{keywordflow}{return} currentVolume;}
\DoxyCodeLine{00308         \}}
\DoxyCodeLine{00309     \}}
\DoxyCodeLine{00310 }
\DoxyCodeLine{00311     \textcolor{keyword}{public} \textcolor{keyword}{class }GetClipboardText}
\DoxyCodeLine{00312     \{}
\DoxyCodeLine{00313         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_GetText;}
\DoxyCodeLine{00314 }
\DoxyCodeLine{00315         \textcolor{keyword}{private} \textcolor{keywordtype}{void} \_thGetText(\textcolor{keywordtype}{object} format)}
\DoxyCodeLine{00316         \{}
\DoxyCodeLine{00317             \textcolor{keywordflow}{try}}
\DoxyCodeLine{00318             \{}
\DoxyCodeLine{00319                 \textcolor{keywordflow}{if} (format == \textcolor{keyword}{null}) \{ \_GetText = Clipboard.GetText(); \}}
\DoxyCodeLine{00320                 \textcolor{keywordflow}{else} \{ \_GetText = Clipboard.GetText((TextDataFormat)format); \}}
\DoxyCodeLine{00321             \}}
\DoxyCodeLine{00322             \textcolor{keywordflow}{catch} \{ \_GetText = \textcolor{keywordtype}{string}.Empty; \}}
\DoxyCodeLine{00323         \}}
\DoxyCodeLine{00324 }
\DoxyCodeLine{00325         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} GetText()}
\DoxyCodeLine{00326         \{}
\DoxyCodeLine{00327             GetClipboardText instance = \textcolor{keyword}{new} GetClipboardText();}
\DoxyCodeLine{00328             Thread staThread = \textcolor{keyword}{new} Thread(instance.\_thGetText);}
\DoxyCodeLine{00329             staThread.SetApartmentState(ApartmentState.STA);}
\DoxyCodeLine{00330             staThread.Start();}
\DoxyCodeLine{00331             staThread.Join();}
\DoxyCodeLine{00332             \textcolor{keywordflow}{return} instance.\_GetText;}
\DoxyCodeLine{00333         \}}
\DoxyCodeLine{00334     \}}
\DoxyCodeLine{00335 }
\DoxyCodeLine{00336     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{class }STATask}
\DoxyCodeLine{00337     \{}
\DoxyCodeLine{00338         \textcolor{keyword}{public} \textcolor{keyword}{static} Task<TResult> Run<TResult>(Func<TResult> \textcolor{keyword}{function})}
\DoxyCodeLine{00339         \{}
\DoxyCodeLine{00340             var tcs = \textcolor{keyword}{new} TaskCompletionSource<TResult>();}
\DoxyCodeLine{00341 }
\DoxyCodeLine{00342             var thread = \textcolor{keyword}{new} Thread(() =>}
\DoxyCodeLine{00343             \{}
\DoxyCodeLine{00344                 \textcolor{keywordflow}{try} \{ tcs.SetResult(\textcolor{keyword}{function}()); \}}
\DoxyCodeLine{00345                 \textcolor{keywordflow}{catch} (Exception e) \{ tcs.SetException(e); \}}
\DoxyCodeLine{00346             \});}
\DoxyCodeLine{00347             thread.SetApartmentState(ApartmentState.STA);}
\DoxyCodeLine{00348             thread.Start();}
\DoxyCodeLine{00349             \textcolor{keywordflow}{return} tcs.Task;}
\DoxyCodeLine{00350         \}}
\DoxyCodeLine{00351 }
\DoxyCodeLine{00352         \textcolor{keyword}{public} \textcolor{keyword}{static} Task Run(Action action)}
\DoxyCodeLine{00353         \{}
\DoxyCodeLine{00354             var tcs = \textcolor{keyword}{new} TaskCompletionSource<object>();}
\DoxyCodeLine{00355             var thread = \textcolor{keyword}{new} Thread(() =>}
\DoxyCodeLine{00356             \{}
\DoxyCodeLine{00357                 \textcolor{keywordflow}{try}}
\DoxyCodeLine{00358                 \{}
\DoxyCodeLine{00359                     action();}
\DoxyCodeLine{00360                     tcs.SetResult(\textcolor{keyword}{null});}
\DoxyCodeLine{00361                 \}}
\DoxyCodeLine{00362                 \textcolor{keywordflow}{catch} (Exception e) \{ tcs.SetException(e); \}}
\DoxyCodeLine{00363             \});}
\DoxyCodeLine{00364             thread.SetApartmentState(ApartmentState.STA);}
\DoxyCodeLine{00365             thread.Start();}
\DoxyCodeLine{00366             \textcolor{keywordflow}{return} tcs.Task;}
\DoxyCodeLine{00367         \}}
\DoxyCodeLine{00368     \}}
\DoxyCodeLine{00369 }
\DoxyCodeLine{00370     \textcolor{keyword}{public} \textcolor{keyword}{class }Keyboard}
\DoxyCodeLine{00371     \{}
\DoxyCodeLine{00372         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} KeyDown(Keys vKey)}
\DoxyCodeLine{00373         \{}
\DoxyCodeLine{00374             Import.keybd\_event((\textcolor{keywordtype}{byte})vKey, 0, (\textcolor{keywordtype}{int})Enums.KEYEVENTF.KEYEVENTF\_EXTENDEDKEY, 0);}
\DoxyCodeLine{00375         \}}
\DoxyCodeLine{00376 }
\DoxyCodeLine{00377         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} KeyUp(Keys vKey)}
\DoxyCodeLine{00378         \{}
\DoxyCodeLine{00379             Import.keybd\_event((\textcolor{keywordtype}{byte})vKey, 0, (\textcolor{keywordtype}{int})Enums.KEYEVENTF.KEYEVENTF\_EXTENDEDKEY | (\textcolor{keywordtype}{int})Enums.KEYEVENTF.KEYEVENTF\_KEYUP, 0);}
\DoxyCodeLine{00380         \}}
\DoxyCodeLine{00381 }
\DoxyCodeLine{00382         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} WindowsKeyboardEventsAPI(\textcolor{keywordtype}{int} status, \textcolor{keywordtype}{string} keys = \textcolor{stringliteral}{"{}none"{}})}
\DoxyCodeLine{00383         \{}
\DoxyCodeLine{00384             \textcolor{keywordflow}{switch} (status)}
\DoxyCodeLine{00385             \{}
\DoxyCodeLine{00386                 \textcolor{keywordflow}{case} -\/1:}
\DoxyCodeLine{00387                     \{}
\DoxyCodeLine{00388                         KeyDown(Keys.LWin);}
\DoxyCodeLine{00389                         KeyDown(Keys.D);}
\DoxyCodeLine{00390                         KeyUp(Keys.LWin);}
\DoxyCodeLine{00391                         KeyUp(Keys.D);}
\DoxyCodeLine{00392                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00393                     \}}
\DoxyCodeLine{00394                 \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{00395                     \{}
\DoxyCodeLine{00396                         KeyDown(Keys.LWin);}
\DoxyCodeLine{00397                         KeyDown(Keys.M);}
\DoxyCodeLine{00398                         KeyUp(Keys.LWin);}
\DoxyCodeLine{00399                         KeyUp(Keys.M);}
\DoxyCodeLine{00400                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00401                     \}}
\DoxyCodeLine{00402                 \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{00403                     \{}
\DoxyCodeLine{00404                         KeyDown(Keys.LWin);}
\DoxyCodeLine{00405                         KeyDown(Keys.LShiftKey);}
\DoxyCodeLine{00406                         KeyDown(Keys.M);}
\DoxyCodeLine{00407                         KeyUp(Keys.LWin);}
\DoxyCodeLine{00408                         KeyUp(Keys.LShiftKey);}
\DoxyCodeLine{00409                         KeyUp(Keys.M);}
\DoxyCodeLine{00410                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00411                     \}}
\DoxyCodeLine{00412             \}}
\DoxyCodeLine{00413         \}}
\DoxyCodeLine{00414     \}}
\DoxyCodeLine{00415 \}}

\end{DoxyCode}
