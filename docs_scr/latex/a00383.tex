\doxysection{Processes Class Reference}
\label{a00383}\index{Processes@{Processes}}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static string \textbf{ Get\+List} ()
\item 
static void \textbf{ Run} (string target\+File, string arguments=\char`\"{}\char`\"{})
\item 
static string \textbf{ Execute} (string target\+File, string arguments)
\item 
static void \textbf{ Open} (string target\+File)
\item 
static Process \textbf{ Only\+One\+Process} ()
\item 
static void \textbf{ Kill\+This} ()
\item 
static void \textbf{ Kill} (string process\+Name\+With\+Exe)
\item 
static bool \textbf{ Is\+Administrator\+\_\+\+Your\+App} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \textbf{ 10} of file \textbf{ Apps.\+cs}.



\doxysubsection{Member Function Documentation}
\mbox{\label{a00383_ac8c4d5d06de749d6d24c46be912c9ce8}} 
\index{Processes@{Processes}!Execute@{Execute}}
\index{Execute@{Execute}!Processes@{Processes}}
\doxysubsubsection{Execute()}
{\footnotesize\ttfamily static string Execute (\begin{DoxyParamCaption}\item[{string}]{target\+File,  }\item[{string}]{arguments }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 48} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050         \{}
\DoxyCodeLine{00051             var codepage = System.Globalization.CultureInfo.CurrentCulture.TextInfo.OEMCodePage;}
\DoxyCodeLine{00052             var desiredEncoding = System.Text.Encoding.GetEncoding(codepage);}
\DoxyCodeLine{00053             var start = \textcolor{keyword}{new} Process}
\DoxyCodeLine{00054             \{}
\DoxyCodeLine{00055                 StartInfo = \textcolor{keyword}{new} ProcessStartInfo}
\DoxyCodeLine{00056                 \{}
\DoxyCodeLine{00057                     FileName = targetFile,}
\DoxyCodeLine{00058                     Arguments = arguments,}
\DoxyCodeLine{00059                     CreateNoWindow = \textcolor{keyword}{true},}
\DoxyCodeLine{00060                     UseShellExecute = \textcolor{keyword}{false},}
\DoxyCodeLine{00061                     Verb = \textcolor{stringliteral}{"{}open"{}},}
\DoxyCodeLine{00062                     WindowStyle = ProcessWindowStyle.Hidden,}
\DoxyCodeLine{00063                     RedirectStandardOutput = \textcolor{keyword}{true},}
\DoxyCodeLine{00064                     StandardOutputEncoding = desiredEncoding}
\DoxyCodeLine{00065                 \}}
\DoxyCodeLine{00066             \};}
\DoxyCodeLine{00067             start.WaitForExit();}
\DoxyCodeLine{00068             start.Start();}
\DoxyCodeLine{00069             \textcolor{keywordtype}{string} output = start.StandardOutput.ReadToEnd();}
\DoxyCodeLine{00070             \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{00071         \}}

\end{DoxyCode}
\mbox{\label{a00383_a07c6c2ccfe855ad26d1693624a81466a}} 
\index{Processes@{Processes}!GetList@{GetList}}
\index{GetList@{GetList}!Processes@{Processes}}
\doxysubsubsection{GetList()}
{\footnotesize\ttfamily static string Get\+List (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 12} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00013         \{}
\DoxyCodeLine{00014             \textcolor{keywordtype}{string} procList = \textcolor{stringliteral}{"{}Все процессы:"{}};}
\DoxyCodeLine{00015             \textcolor{keywordflow}{foreach} (Process process \textcolor{keywordflow}{in} Process.GetProcesses())}
\DoxyCodeLine{00016             \{}
\DoxyCodeLine{00017                 var procSize = \textcolor{stringliteral}{"{}0x0"{}};}
\DoxyCodeLine{00018                 \textcolor{keywordflow}{try}}
\DoxyCodeLine{00019                 \{}
\DoxyCodeLine{00020                     var counter = \textcolor{keyword}{new} PerformanceCounter(\textcolor{stringliteral}{"{}Process"{}}, \textcolor{stringliteral}{"{}Working Set -\/ Private"{}}, process.ProcessName);}
\DoxyCodeLine{00021                     procSize = Convert.ToString(counter.RawValue / 1048576);}
\DoxyCodeLine{00022                 \}}
\DoxyCodeLine{00023                 \textcolor{keywordflow}{catch} \{ \}}
\DoxyCodeLine{00024                 \textcolor{keywordflow}{if} (procSize != \textcolor{stringliteral}{"{}0x0"{}} \&\& procSize != \textcolor{stringliteral}{"{}0"{}})}
\DoxyCodeLine{00025                     procList += \$\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nИмя поцесса: \{process.ProcessName\}.exe"{}} +}
\DoxyCodeLine{00026                         \$\textcolor{stringliteral}{"{}\(\backslash\)nID: \{process.Id\}"{}} +}
\DoxyCodeLine{00027                         \$\textcolor{stringliteral}{"{}\(\backslash\)nПамять: \{procSize\} МБ"{}} +}
\DoxyCodeLine{00028                         \$\textcolor{stringliteral}{"{}\(\backslash\)nTitle \& Handle: \(\backslash\)"{}\{process.MainWindowTitle\}\(\backslash\)"{} \& \{process.MainWindowHandle\}"{}};}
\DoxyCodeLine{00029             \}}
\DoxyCodeLine{00030             \textcolor{keywordflow}{return} procList;}
\DoxyCodeLine{00031         \}}

\end{DoxyCode}
\mbox{\label{a00383_a7789de9383b84db1e58f51ea903fa32f}} 
\index{Processes@{Processes}!IsAdministrator\_YourApp@{IsAdministrator\_YourApp}}
\index{IsAdministrator\_YourApp@{IsAdministrator\_YourApp}!Processes@{Processes}}
\doxysubsubsection{IsAdministrator\_YourApp()}
{\footnotesize\ttfamily static bool Is\+Administrator\+\_\+\+Your\+App (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 118} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00119         \{}
\DoxyCodeLine{00120             \textcolor{keywordflow}{return} \textcolor{keyword}{new} WindowsPrincipal(WindowsIdentity.GetCurrent()).IsInRole(WindowsBuiltInRole.Administrator);}
\DoxyCodeLine{00121         \}}

\end{DoxyCode}
\mbox{\label{a00383_a7aa1ac8e490b5f31ced250e9650290ec}} 
\index{Processes@{Processes}!Kill@{Kill}}
\index{Kill@{Kill}!Processes@{Processes}}
\doxysubsubsection{Kill()}
{\footnotesize\ttfamily static void Kill (\begin{DoxyParamCaption}\item[{string}]{process\+Name\+With\+Exe }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 103} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00104         \{}
\DoxyCodeLine{00105             var start = \textcolor{keyword}{new} Process}
\DoxyCodeLine{00106             \{}
\DoxyCodeLine{00107                 StartInfo = \textcolor{keyword}{new} ProcessStartInfo}
\DoxyCodeLine{00108                 \{}
\DoxyCodeLine{00109                     FileName = \textcolor{stringliteral}{"{}taskkill"{}},}
\DoxyCodeLine{00110                     Arguments = \$\textcolor{stringliteral}{"{}/IM \(\backslash\)"{}\{processNameWithExe\}\(\backslash\)"{} /F /T"{}},}
\DoxyCodeLine{00111                     CreateNoWindow = \textcolor{keyword}{true},}
\DoxyCodeLine{00112                     WindowStyle = ProcessWindowStyle.Hidden,}
\DoxyCodeLine{00113                 \}}
\DoxyCodeLine{00114             \};}
\DoxyCodeLine{00115             start.Start();}
\DoxyCodeLine{00116         \}}

\end{DoxyCode}
\mbox{\label{a00383_a6511631d1d2cfa8fdafe82658284d200}} 
\index{Processes@{Processes}!KillThis@{KillThis}}
\index{KillThis@{KillThis}!Processes@{Processes}}
\doxysubsubsection{KillThis()}
{\footnotesize\ttfamily static void Kill\+This (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 98} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00099         \{}
\DoxyCodeLine{00100             Process.GetCurrentProcess().Kill();}
\DoxyCodeLine{00101         \}}

\end{DoxyCode}
\mbox{\label{a00383_ab74fa316fa9b807910c6a87fcb326d94}} 
\index{Processes@{Processes}!OnlyOneProcess@{OnlyOneProcess}}
\index{OnlyOneProcess@{OnlyOneProcess}!Processes@{Processes}}
\doxysubsubsection{OnlyOneProcess()}
{\footnotesize\ttfamily static Process Only\+One\+Process (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 83} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084         \{}
\DoxyCodeLine{00085             Process current = Process.GetCurrentProcess();}
\DoxyCodeLine{00086             Process[] pr = Process.GetProcessesByName(current.ProcessName);}
\DoxyCodeLine{00087             \textcolor{keywordflow}{foreach} (Process i \textcolor{keywordflow}{in} pr)}
\DoxyCodeLine{00088             \{}
\DoxyCodeLine{00089                 \textcolor{keywordflow}{if} (i.Id != current.Id)}
\DoxyCodeLine{00090                 \{}
\DoxyCodeLine{00091                     \textcolor{keywordflow}{if} (Assembly.GetExecutingAssembly().Location.Replace(\textcolor{stringliteral}{"{}/"{}}, \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}) == current.MainModule.FileName)}
\DoxyCodeLine{00092                     \{ \textcolor{keywordflow}{return} i; \}}
\DoxyCodeLine{00093                 \}}
\DoxyCodeLine{00094             \}}
\DoxyCodeLine{00095             \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{00096         \}}

\end{DoxyCode}
\mbox{\label{a00383_ac00a68a4ee61cd8082f1ae7644604d1c}} 
\index{Processes@{Processes}!Open@{Open}}
\index{Open@{Open}!Processes@{Processes}}
\doxysubsubsection{Open()}
{\footnotesize\ttfamily static void Open (\begin{DoxyParamCaption}\item[{string}]{target\+File }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 73} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00074         \{}
\DoxyCodeLine{00075             var ps = \textcolor{keyword}{new} ProcessStartInfo(targetFile)}
\DoxyCodeLine{00076             \{}
\DoxyCodeLine{00077                 UseShellExecute = \textcolor{keyword}{true},}
\DoxyCodeLine{00078                 Verb = \textcolor{stringliteral}{"{}open"{}}}
\DoxyCodeLine{00079             \};}
\DoxyCodeLine{00080             Process.Start(ps);}
\DoxyCodeLine{00081         \}}

\end{DoxyCode}
\mbox{\label{a00383_a35b06e64668372453292389fffb0a211}} 
\index{Processes@{Processes}!Run@{Run}}
\index{Run@{Run}!Processes@{Processes}}
\doxysubsubsection{Run()}
{\footnotesize\ttfamily static void Run (\begin{DoxyParamCaption}\item[{string}]{target\+File,  }\item[{string}]{arguments = {\ttfamily \char`\"{}\char`\"{}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 33} of file \textbf{ Apps.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00035         \{}
\DoxyCodeLine{00036             var start = \textcolor{keyword}{new} Process}
\DoxyCodeLine{00037             \{}
\DoxyCodeLine{00038                 StartInfo = \textcolor{keyword}{new} ProcessStartInfo}
\DoxyCodeLine{00039                 \{}
\DoxyCodeLine{00040                     FileName = targetFile,}
\DoxyCodeLine{00041                     Arguments = arguments,}
\DoxyCodeLine{00042                     Verb = \textcolor{stringliteral}{"{}open"{}}}
\DoxyCodeLine{00043                 \}}
\DoxyCodeLine{00044             \};}
\DoxyCodeLine{00045             start.Start();}
\DoxyCodeLine{00046         \}}

\end{DoxyCode}
