\doxysection{Vit\+NX\+\_\+\+Message\+Box.\+cs}
\label{a00236_source}\index{E:/Github/VitNX/VitNX/UI/BasedOnDarkUI/Forms/VitNX\_MessageBox.cs@{E:/Github/VitNX/VitNX/UI/BasedOnDarkUI/Forms/VitNX\_MessageBox.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.ComponentModel;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} System.Drawing;}
\DoxyCodeLine{00004 \textcolor{keyword}{using} System.Windows.Forms;}
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{keyword}{namespace }VitNX.UI.BasedOnDarkUI.Forms}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00008     \textcolor{keyword}{public} \textcolor{keyword}{partial class }VitNX\_MessageBox : VitNX\_Dialog}
\DoxyCodeLine{00009     \{}
\DoxyCodeLine{00010 \textcolor{preprocessor}{        \#region Field Region}}
\DoxyCodeLine{00011 }
\DoxyCodeLine{00012         \textcolor{keyword}{protected} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnHandleCreated(EventArgs e)}
\DoxyCodeLine{00013         \{}
\DoxyCodeLine{00014             \textcolor{keywordflow}{if} (Functions.Windows.Win32.Import.DwmSetWindowAttribute(Handle, 19, \textcolor{keyword}{new}[] \{ 1 \}, 4) != 0)}
\DoxyCodeLine{00015                 Functions.Windows.Win32.Import.DwmSetWindowAttribute(Handle, 20, \textcolor{keyword}{new}[] \{ 1 \}, 4);}
\DoxyCodeLine{00016         \}}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018         \textcolor{keyword}{private} \textcolor{keywordtype}{string} \_message;}
\DoxyCodeLine{00019         \textcolor{keyword}{private} \textcolor{keywordtype}{int} \_maximumWidth = 350;}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021 \textcolor{preprocessor}{        \#endregion Field Region}}
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 \textcolor{preprocessor}{        \#region Property Region}}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025         [Description(\textcolor{stringliteral}{"{}Determines the maximum width of the message box when it autosizes around the displayed message."{}})]}
\DoxyCodeLine{00026         [DefaultValue(350)]}
\DoxyCodeLine{00027         \textcolor{keyword}{public} \textcolor{keywordtype}{int} MaximumWidth}
\DoxyCodeLine{00028         \{}
\DoxyCodeLine{00029             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \_maximumWidth; \}}
\DoxyCodeLine{00030             \textcolor{keyword}{set}}
\DoxyCodeLine{00031             \{}
\DoxyCodeLine{00032                 \_maximumWidth = value;}
\DoxyCodeLine{00033                 CalculateSize();}
\DoxyCodeLine{00034             \}}
\DoxyCodeLine{00035         \}}
\DoxyCodeLine{00036 }
\DoxyCodeLine{00037 \textcolor{preprocessor}{        \#endregion Property Region}}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039 \textcolor{preprocessor}{        \#region Constructor Region}}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041         \textcolor{keyword}{public} VitNX\_MessageBox()}
\DoxyCodeLine{00042         \{}
\DoxyCodeLine{00043             InitializeComponent();}
\DoxyCodeLine{00044         \}}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046         \textcolor{keyword}{public} VitNX\_MessageBox(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} title, VitNX\_MessageBoxIcon icon, VitNX\_DialogButton buttons)}
\DoxyCodeLine{00047             : \textcolor{keyword}{this}()}
\DoxyCodeLine{00048         \{}
\DoxyCodeLine{00049             Text = title;}
\DoxyCodeLine{00050             \_message = message;}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052             DialogButtons = buttons;}
\DoxyCodeLine{00053             SetIcon(icon);}
\DoxyCodeLine{00054         \}}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056         \textcolor{keyword}{public} VitNX\_MessageBox(\textcolor{keywordtype}{string} message)}
\DoxyCodeLine{00057             : \textcolor{keyword}{this}(message, \textcolor{keyword}{null}, VitNX\_MessageBoxIcon.None, VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00058         \{ \}}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060         \textcolor{keyword}{public} VitNX\_MessageBox(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} title)}
\DoxyCodeLine{00061             : \textcolor{keyword}{this}(message, title, VitNX\_MessageBoxIcon.None, VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00062         \{ \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064         \textcolor{keyword}{public} VitNX\_MessageBox(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} title, VitNX\_DialogButton buttons)}
\DoxyCodeLine{00065             : \textcolor{keyword}{this}(message, title, VitNX\_MessageBoxIcon.None, buttons)}
\DoxyCodeLine{00066         \{ \}}
\DoxyCodeLine{00067 }
\DoxyCodeLine{00068         \textcolor{keyword}{public} VitNX\_MessageBox(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} title, VitNX\_MessageBoxIcon icon)}
\DoxyCodeLine{00069             : \textcolor{keyword}{this}(message, title, icon, VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00070         \{ \}}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072 \textcolor{preprocessor}{        \#endregion Constructor Region}}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074 \textcolor{preprocessor}{        \#region Static Method Region}}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076         \textcolor{keyword}{public} \textcolor{keyword}{static} DialogResult ShowInfo(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} caption, VitNX\_DialogButton buttons = VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00077         \{}
\DoxyCodeLine{00078             \textcolor{keywordflow}{return} ShowDialog(message, caption, VitNX\_MessageBoxIcon.Information, buttons);}
\DoxyCodeLine{00079         \}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081         \textcolor{keyword}{public} \textcolor{keyword}{static} DialogResult ShowWarning(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} caption, VitNX\_DialogButton buttons = VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00082         \{}
\DoxyCodeLine{00083             \textcolor{keywordflow}{return} ShowDialog(message, caption, VitNX\_MessageBoxIcon.Warning, buttons);}
\DoxyCodeLine{00084         \}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086         \textcolor{keyword}{public} \textcolor{keyword}{static} DialogResult ShowError(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} caption, VitNX\_DialogButton buttons = VitNX\_DialogButton.Ok)}
\DoxyCodeLine{00087         \{}
\DoxyCodeLine{00088             \textcolor{keywordflow}{return} ShowDialog(message, caption, VitNX\_MessageBoxIcon.Error, buttons);}
\DoxyCodeLine{00089         \}}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091         \textcolor{keyword}{public} \textcolor{keyword}{static} DialogResult ShowQuestion(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} caption, VitNX\_DialogButton buttons = VitNX\_DialogButton.YesNo)}
\DoxyCodeLine{00092         \{}
\DoxyCodeLine{00093             \textcolor{keywordflow}{return} ShowDialog(message, caption, VitNX\_MessageBoxIcon.Question, buttons);}
\DoxyCodeLine{00094         \}}
\DoxyCodeLine{00095 }
\DoxyCodeLine{00096         \textcolor{keyword}{private} \textcolor{keyword}{static} DialogResult ShowDialog(\textcolor{keywordtype}{string} message, \textcolor{keywordtype}{string} caption, VitNX\_MessageBoxIcon icon, VitNX\_DialogButton buttons)}
\DoxyCodeLine{00097         \{}
\DoxyCodeLine{00098             \textcolor{keyword}{using} (var dlg = \textcolor{keyword}{new} VitNX\_MessageBox(message, caption, icon, buttons))}
\DoxyCodeLine{00099             \{}
\DoxyCodeLine{00100                 var result = dlg.ShowDialog();}
\DoxyCodeLine{00101                 \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00102             \}}
\DoxyCodeLine{00103         \}}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105 \textcolor{preprocessor}{        \#endregion Static Method Region}}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107 \textcolor{preprocessor}{        \#region Method Region}}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109         \textcolor{keyword}{private} \textcolor{keywordtype}{void} SetIcon(VitNX\_MessageBoxIcon icon)}
\DoxyCodeLine{00110         \{}
\DoxyCodeLine{00111             \textcolor{keywordflow}{switch} (icon)}
\DoxyCodeLine{00112             \{}
\DoxyCodeLine{00113                 \textcolor{keywordflow}{case} VitNX\_MessageBoxIcon.None:}
\DoxyCodeLine{00114                     picIcon.Visible = \textcolor{keyword}{false};}
\DoxyCodeLine{00115                     lblText.Left = 10;}
\DoxyCodeLine{00116                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118                 \textcolor{keywordflow}{case} VitNX\_MessageBoxIcon.Information:}
\DoxyCodeLine{00119                     picIcon.Image = MessageBoxIcons.info;}
\DoxyCodeLine{00120                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122                 \textcolor{keywordflow}{case} VitNX\_MessageBoxIcon.Warning:}
\DoxyCodeLine{00123                     picIcon.Image = MessageBoxIcons.warning;}
\DoxyCodeLine{00124                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126                 \textcolor{keywordflow}{case} VitNX\_MessageBoxIcon.Error:}
\DoxyCodeLine{00127                     picIcon.Image = MessageBoxIcons.error;}
\DoxyCodeLine{00128                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130                 \textcolor{keywordflow}{case} VitNX\_MessageBoxIcon.Question:}
\DoxyCodeLine{00131                     picIcon.Image = MessageBoxIcons.question;}
\DoxyCodeLine{00132                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{00133             \}}
\DoxyCodeLine{00134         \}}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136         \textcolor{keyword}{private} \textcolor{keywordtype}{void} CalculateSize()}
\DoxyCodeLine{00137         \{}
\DoxyCodeLine{00138             var width = 260; var height = 124;}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140             \textcolor{comment}{// Reset form back to original size}}
\DoxyCodeLine{00141             Size = \textcolor{keyword}{new} Size(width, height);}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143             lblText.Text = \textcolor{keywordtype}{string}.Empty;}
\DoxyCodeLine{00144             lblText.AutoSize = \textcolor{keyword}{true};}
\DoxyCodeLine{00145             lblText.Text = \_message;}
\DoxyCodeLine{00146 }
\DoxyCodeLine{00147             \textcolor{comment}{// Set the minimum dialog size to whichever is bigger -\/ the original size or the buttons.}}
\DoxyCodeLine{00148             var minWidth = Math.Max(width, TotalButtonSize + 15);}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150             \textcolor{comment}{// Calculate the total size of the message}}
\DoxyCodeLine{00151             var totalWidth = lblText.Right + 25;}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153             \textcolor{comment}{// Make sure we're not making the dialog bigger than the maximum size}}
\DoxyCodeLine{00154             \textcolor{keywordflow}{if} (totalWidth < \_maximumWidth)}
\DoxyCodeLine{00155             \{}
\DoxyCodeLine{00156                 \textcolor{comment}{// Width is smaller than the maximum width.}}
\DoxyCodeLine{00157                 \textcolor{comment}{// This means we can have a single-\/line message box.}}
\DoxyCodeLine{00158                 \textcolor{comment}{// Move the label to accomodate this.}}
\DoxyCodeLine{00159                 width = totalWidth;}
\DoxyCodeLine{00160                 lblText.Top = picIcon.Top + (picIcon.Height / 2) -\/ (lblText.Height / 2);}
\DoxyCodeLine{00161             \}}
\DoxyCodeLine{00162             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00163             \{}
\DoxyCodeLine{00164                 \textcolor{comment}{// Width is larger than the maximum width.}}
\DoxyCodeLine{00165                 \textcolor{comment}{// Change the label size and wrap it.}}
\DoxyCodeLine{00166                 width = \_maximumWidth;}
\DoxyCodeLine{00167                 var offsetHeight = Height -\/ picIcon.Height;}
\DoxyCodeLine{00168                 lblText.AutoUpdateHeight = \textcolor{keyword}{true};}
\DoxyCodeLine{00169                 lblText.Width = width -\/ lblText.Left -\/ 25;}
\DoxyCodeLine{00170                 height = offsetHeight + lblText.Height;}
\DoxyCodeLine{00171             \}}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173             \textcolor{comment}{// Force the width to the minimum width}}
\DoxyCodeLine{00174             \textcolor{keywordflow}{if} (width < minWidth)}
\DoxyCodeLine{00175                 width = minWidth;}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177             \textcolor{comment}{// Set the new size of the dialog}}
\DoxyCodeLine{00178             Size = \textcolor{keyword}{new} Size(width, height);}
\DoxyCodeLine{00179         \}}
\DoxyCodeLine{00180 }
\DoxyCodeLine{00181 \textcolor{preprocessor}{        \#endregion Method Region}}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183 \textcolor{preprocessor}{        \#region Event Handler Region}}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00185         \textcolor{keyword}{protected} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnLoad(EventArgs e)}
\DoxyCodeLine{00186         \{}
\DoxyCodeLine{00187             base.OnLoad(e);}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189             CalculateSize();}
\DoxyCodeLine{00190         \}}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192 \textcolor{preprocessor}{        \#endregion Event Handler Region}}
\DoxyCodeLine{00193     \}}
\DoxyCodeLine{00194 \}}

\end{DoxyCode}
