\doxysection{Windows Class Reference}
\label{a00339}\index{Windows@{Windows}}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static Memory\+Stream \textbf{ Get\+Screen} ()
\item 
static void \textbf{ Get\+All\+Users} ()
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static string \textbf{ \+\_\+computer\+Name} = Environment.\+Machine\+Name
\item 
static string \textbf{ \+\_\+current\+Username} = Environment.\+User\+Name
\item 
static Date\+Time \textbf{ \+\_\+local\+Time} = new Microsoft.\+Visual\+Basic.\+Devices.\+Clock().Local\+Time
\item 
static bool \textbf{ \+\_\+is64bit} = Environment.\+Is64\+Bit\+Operating\+System
\item 
static string \textbf{ \+\_\+windows\+Version} = Convert.\+To\+String(Environment.\+OSVersion.\+Version)
\item 
static double \textbf{ \+\_\+windows\+Version\+From\+REG} = double.\+Parse((string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Current\+Version\char`\"{}, \char`\"{}\char`\"{}), System.\+Globalization.\+Culture\+Info.\+Invariant\+Culture)
\item 
static string \textbf{ \+\_\+windows\+Edition\+IDFrom\+REG} = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Edition\+ID\char`\"{}, \char`\"{}\char`\"{})
\item 
static string \textbf{ \+\_\+windows\+Current\+Build\+Number\+From\+REG} = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Current\+Build\+Number\char`\"{}, \char`\"{}\char`\"{})
\item 
static string \textbf{ \+\_\+windows\+Product\+Name\+From\+REG} = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Product\+Name\char`\"{}, \char`\"{}\char`\"{})
\item 
static string \textbf{ \+\_\+windows\+Display\+Version\+From\+REG} = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Display\+Version\char`\"{}, \char`\"{}\char`\"{})
\item 
static string \textbf{ \+\_\+windows\+Release\+Id\+From\+REG} = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Release\+Id\char`\"{}, \char`\"{}\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \textbf{ 20} of file \textbf{ Information.\+cs}.



\doxysubsection{Member Function Documentation}
\mbox{\label{a00339_acfa3b25cf077cb14cf3d18c3a0376149}} 
\index{Windows@{Windows}!GetAllUsers@{GetAllUsers}}
\index{GetAllUsers@{GetAllUsers}!Windows@{Windows}}
\doxysubsubsection{GetAllUsers()}
{\footnotesize\ttfamily static void Get\+All\+Users (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 45} of file \textbf{ Information.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00046         \{}
\DoxyCodeLine{00047             \textcolor{keywordtype}{string} users = Processes.Execute(\textcolor{stringliteral}{"{}wmic"{}}, \textcolor{stringliteral}{"{}useraccount list full"{}});}
\DoxyCodeLine{00048             \textcolor{keywordtype}{string} temp\_file = \$\textcolor{stringliteral}{@"{}\{Path.GetTempPath()\}\(\backslash\)Пользователи.txt"{}};}
\DoxyCodeLine{00049             FileSystem.WriteTextToFileUTF8(users, temp\_file);}
\DoxyCodeLine{00050             \textcolor{keywordtype}{string}[] lines = File.ReadAllLines(temp\_file);}
\DoxyCodeLine{00051             \textcolor{keyword}{using} (StreamWriter writer = \textcolor{keyword}{new} StreamWriter(temp\_file))}
\DoxyCodeLine{00052             \{}
\DoxyCodeLine{00053                 \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} line \textcolor{keywordflow}{in} lines)}
\DoxyCodeLine{00054                 \{}
\DoxyCodeLine{00055                     \textcolor{keywordflow}{if} (!\textcolor{keywordtype}{string}.IsNullOrWhiteSpace(line))}
\DoxyCodeLine{00056                         writer.WriteLine(line);}
\DoxyCodeLine{00057                 \}}
\DoxyCodeLine{00058             \}}
\DoxyCodeLine{00059             \textcolor{keywordtype}{string}[] rep = File.ReadAllLines(temp\_file);}
\DoxyCodeLine{00060             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < rep.Length; i++)}
\DoxyCodeLine{00061             \{}
\DoxyCodeLine{00062                 \textcolor{keywordflow}{if} (i == 0)}
\DoxyCodeLine{00063                 \{}
\DoxyCodeLine{00064                     rep[0] = \textcolor{stringliteral}{"{}Пользователи:\(\backslash\)n\(\backslash\)n"{}} + rep[0];}
\DoxyCodeLine{00065                 \}}
\DoxyCodeLine{00066                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}TRUE"{}}, \textcolor{stringliteral}{"{}Да"{}});}
\DoxyCodeLine{00067                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}FALSE"{}}, \textcolor{stringliteral}{"{}Нет"{}});}
\DoxyCodeLine{00068                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Description"{}}, \textcolor{stringliteral}{"{}Описание"{}});}
\DoxyCodeLine{00069                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Domain"{}}, \textcolor{stringliteral}{"{}Домен"{}});}
\DoxyCodeLine{00070                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}FullName"{}}, \textcolor{stringliteral}{"{}Полное имя"{}});}
\DoxyCodeLine{00071                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Name"{}}, \textcolor{stringliteral}{"{}Имя"{}});}
\DoxyCodeLine{00072                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}LocalAccount"{}}, \textcolor{stringliteral}{"{}Локальная запись"{}});}
\DoxyCodeLine{00073                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Disabled"{}}, \textcolor{stringliteral}{"{}Отключена"{}});}
\DoxyCodeLine{00074                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Status"{}}, \textcolor{stringliteral}{"{}Статус"{}});}
\DoxyCodeLine{00075                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Lockout"{}}, \textcolor{stringliteral}{"{}Блокировка"{}});}
\DoxyCodeLine{00076                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}Degraded"{}}, \textcolor{stringliteral}{"{}Отключён\(\backslash\)n"{}});}
\DoxyCodeLine{00077                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}InstallDate"{}}, \textcolor{stringliteral}{"{}Дата создания"{}});}
\DoxyCodeLine{00078                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}AccountType"{}}, \textcolor{stringliteral}{"{}Тип учётной записи"{}});}
\DoxyCodeLine{00079                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordChangeable"{}}, \textcolor{stringliteral}{"{}Пароль можно изменить"{}});}
\DoxyCodeLine{00080                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordExpires"{}}, \textcolor{stringliteral}{"{}Срок действия пароля истекает"{}});}
\DoxyCodeLine{00081                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}PasswordRequired"{}}, \textcolor{stringliteral}{"{}Требуется пароль"{}});}
\DoxyCodeLine{00082                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}512"{}}, \textcolor{stringliteral}{"{}Обычный [512]"{}}).Replace(\textcolor{stringliteral}{"{}2"{}}, \textcolor{stringliteral}{"{}Отключённый [2]"{}}).Replace(\textcolor{stringliteral}{"{}256"{}}, \textcolor{stringliteral}{"{}Временная дублирующая учётная запись [256]"{}}).Replace(\textcolor{stringliteral}{"{}128"{}}, \textcolor{stringliteral}{"{}Разрешён зашифрованный пароль [128]"{}});}
\DoxyCodeLine{00083                 rep[i] = rep[i].Replace(\textcolor{stringliteral}{"{}OK"{}}, \textcolor{stringliteral}{"{}Включён\(\backslash\)n"{}});}
\DoxyCodeLine{00084             \}}
\DoxyCodeLine{00085             File.WriteAllLines(temp\_file, rep);}
\DoxyCodeLine{00086         \}}

\end{DoxyCode}
\mbox{\label{a00339_af639d5b2963f93e55ab0bc9e41f386f6}} 
\index{Windows@{Windows}!GetScreen@{GetScreen}}
\index{GetScreen@{GetScreen}!Windows@{Windows}}
\doxysubsubsection{GetScreen()}
{\footnotesize\ttfamily static Memory\+Stream Get\+Screen (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 34} of file \textbf{ Information.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00035         \{}
\DoxyCodeLine{00036             Bitmap BM = \textcolor{keyword}{new} Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height);}
\DoxyCodeLine{00037             Graphics GH = Graphics.FromImage(BM);}
\DoxyCodeLine{00038             GH.CopyFromScreen(0, 0, 0, 0, BM.Size);}
\DoxyCodeLine{00039             MemoryStream memoryStream = \textcolor{keyword}{new} MemoryStream();}
\DoxyCodeLine{00040             BM.Save(memoryStream, System.Drawing.Imaging.ImageFormat.Png);}
\DoxyCodeLine{00041             memoryStream.Position = 0;}
\DoxyCodeLine{00042             \textcolor{keywordflow}{return} memoryStream;}
\DoxyCodeLine{00043         \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\label{a00339_a6c5244c5eb651493e28bc6499bd52d05}} 
\index{Windows@{Windows}!\_computerName@{\_computerName}}
\index{\_computerName@{\_computerName}!Windows@{Windows}}
\doxysubsubsection{\_computerName}
{\footnotesize\ttfamily string \+\_\+computer\+Name = Environment.\+Machine\+Name\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 22} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a75f0c9f212fcff664c73c80a433bb30a}} 
\index{Windows@{Windows}!\_currentUsername@{\_currentUsername}}
\index{\_currentUsername@{\_currentUsername}!Windows@{Windows}}
\doxysubsubsection{\_currentUsername}
{\footnotesize\ttfamily string \+\_\+current\+Username = Environment.\+User\+Name\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 23} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a053129a3ef1a36a1bebad475abda1c29}} 
\index{Windows@{Windows}!\_is64bit@{\_is64bit}}
\index{\_is64bit@{\_is64bit}!Windows@{Windows}}
\doxysubsubsection{\_is64bit}
{\footnotesize\ttfamily bool \+\_\+is64bit = Environment.\+Is64\+Bit\+Operating\+System\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 25} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a22b9ea4ab3b34a7f15c30edcfccb0129}} 
\index{Windows@{Windows}!\_localTime@{\_localTime}}
\index{\_localTime@{\_localTime}!Windows@{Windows}}
\doxysubsubsection{\_localTime}
{\footnotesize\ttfamily Date\+Time \+\_\+local\+Time = new Microsoft.\+Visual\+Basic.\+Devices.\+Clock().Local\+Time\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 24} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_ab64dcb415074919a1b2d76ab53565002}} 
\index{Windows@{Windows}!\_windowsCurrentBuildNumberFromREG@{\_windowsCurrentBuildNumberFromREG}}
\index{\_windowsCurrentBuildNumberFromREG@{\_windowsCurrentBuildNumberFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsCurrentBuildNumberFromREG}
{\footnotesize\ttfamily string \+\_\+windows\+Current\+Build\+Number\+From\+REG = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Current\+Build\+Number\char`\"{}, \char`\"{}\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 29} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_ac34deb23c137f409433bb07d95db0699}} 
\index{Windows@{Windows}!\_windowsDisplayVersionFromREG@{\_windowsDisplayVersionFromREG}}
\index{\_windowsDisplayVersionFromREG@{\_windowsDisplayVersionFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsDisplayVersionFromREG}
{\footnotesize\ttfamily string \+\_\+windows\+Display\+Version\+From\+REG = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Display\+Version\char`\"{}, \char`\"{}\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 31} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a408a883857cd1df22aac9ed0fcabc101}} 
\index{Windows@{Windows}!\_windowsEditionIDFromREG@{\_windowsEditionIDFromREG}}
\index{\_windowsEditionIDFromREG@{\_windowsEditionIDFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsEditionIDFromREG}
{\footnotesize\ttfamily string \+\_\+windows\+Edition\+IDFrom\+REG = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Edition\+ID\char`\"{}, \char`\"{}\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 28} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a605ea11c23d2877280e804ae27d760af}} 
\index{Windows@{Windows}!\_windowsProductNameFromREG@{\_windowsProductNameFromREG}}
\index{\_windowsProductNameFromREG@{\_windowsProductNameFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsProductNameFromREG}
{\footnotesize\ttfamily string \+\_\+windows\+Product\+Name\+From\+REG = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Product\+Name\char`\"{}, \char`\"{}\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 30} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_ac305f669be8b8c17f691d6e8ec99beb7}} 
\index{Windows@{Windows}!\_windowsReleaseIdFromREG@{\_windowsReleaseIdFromREG}}
\index{\_windowsReleaseIdFromREG@{\_windowsReleaseIdFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsReleaseIdFromREG}
{\footnotesize\ttfamily string \+\_\+windows\+Release\+Id\+From\+REG = (string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Release\+Id\char`\"{}, \char`\"{}\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 32} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a199b71f5bc3f05d24e9f57b7a4fd012e}} 
\index{Windows@{Windows}!\_windowsVersion@{\_windowsVersion}}
\index{\_windowsVersion@{\_windowsVersion}!Windows@{Windows}}
\doxysubsubsection{\_windowsVersion}
{\footnotesize\ttfamily string \+\_\+windows\+Version = Convert.\+To\+String(Environment.\+OSVersion.\+Version)\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 26} of file \textbf{ Information.\+cs}.

\mbox{\label{a00339_a34681d849fc59c231256ccdf392d9866}} 
\index{Windows@{Windows}!\_windowsVersionFromREG@{\_windowsVersionFromREG}}
\index{\_windowsVersionFromREG@{\_windowsVersionFromREG}!Windows@{Windows}}
\doxysubsubsection{\_windowsVersionFromREG}
{\footnotesize\ttfamily double \+\_\+windows\+Version\+From\+REG = double.\+Parse((string)Registry.\+Get\+Value(@\char`\"{}HKEY\+\_\+\+LOCAL\+\_\+\+MACHINE\textbackslash{}\+SOFTWARE\textbackslash{}\+Microsoft\textbackslash{}\+Windows NT\textbackslash{}\+Current\+Version\char`\"{}, \char`\"{}Current\+Version\char`\"{}, \char`\"{}\char`\"{}), System.\+Globalization.\+Culture\+Info.\+Invariant\+Culture)\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \textbf{ 27} of file \textbf{ Information.\+cs}.

